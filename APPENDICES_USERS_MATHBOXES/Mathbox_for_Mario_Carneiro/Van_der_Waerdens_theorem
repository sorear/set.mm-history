$(
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
                       Van der Waerden's theorem
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
$)

  $(
  @{
    vdw.a @e |- A = ( k e. NN0 |-> ( a e. NN , d e. NN |->
      ran ( m e. ( 0 ... ( k - 1 ) ) |-> ( a + ( m x. d ) ) ) ) ) @.
    @( Define the arithmetic progression function, which takes as input a
       length ` k ` , a start point ` a ` , and a step ` d ` and outputs the
       set of points in this progression. @)
    vdwapfval @p |- ( K e. NN0 -> ( A ` K ) = ( a e. NN , d e. NN |->
      ran ( m e. ( 0 ... ( K - 1 ) ) |-> ( a + ( m x. d ) ) ) ) ) @=
      ( cn cc0 cv c1 cmin co cfz cmpt crn cmpt2 wceq wcel nnex cmul caddc simp1
      cn0 w3a oveq1d oveq2d mpteq1 syl rneqd mpt2eq3dva mpt2ex fvmpt ) BDEFHHCI
      BJZKLMZNMZEJZCJFJZUAMUBMZOZPZQEFHHCIDKLMZNMZUSOZPZQUDAUNDRZEFHHVAVEVFUQHS
      ZURHSZUEZUTVDVIUPVCRUTVDRVIUOVBINVIUNDKLVFVGVHUCUFUGCUPVCUSUHUIUJUKGEFHHV
      ETTULUM @.
      @( [18-Aug-2014] @)

    @( The arithmetic progression function is a function. @)
    vdwapf @p |- ( K e. NN0 -> ( A ` K ) : ( NN X. NN ) --> ~P NN ) @=
      ( cn0 wcel cn cxp cpw cfv wf co cv wral wa syl2anc eqid cc0 cmin cfz cmul
      c1 caddc cmpt crn cmpt2 wss simpll elfznn0 adantl nnnn0 ad2antlr nn0mulcl
      nnnn0addcl fmptd frn syl nnex elpw2 sylibr rgen2a fmpt2 mpbi feq1d mpbiri
      vdwlema ) DHIZJJKZJLZDAMZNVKVLEFJJCUADUEUBOZUCOZEPZCPZFPZUDOZUFOZUGZUHZUI
      ZNZWBVLIZFJQEJQWDWEEFJVPJIZVRJIZRZWBJUJZWEWHVOJWANWIWHCVOVTJWAWHVQVOIZRZW
      FVSHIZVTJIWFWGWJUKWKVQHIZVRHIZWLWJWMWHVQVNULUMWGWNWFWJVRUNUOVQVRUPSVPVSUQ
      SWATURVOJWAUSUTWBJVAVBVCVDEFJJWBVLWCWCTVEVFVJVKVLVMWCABCDEFGVIVGVH @.
      @( [18-Aug-2014] @)

    @( Value of the arithmetic progression function. @)
    vdwapval @p |- ( ( K e. NN0 /\ T e. NN /\ D e. NN ) ->
      ( X e. ( T ( A ` K ) D ) <->
        E. m e. ( 0 ... ( K - 1 ) ) X = ( T + ( m x. D ) ) ) ) @=
      ( vx wcel cn co cv cmul caddc wceq wrex cn0 w3a cfv cc0 cmin cfz cab cmpt
      c1 crn cmpt2 3ad2ant1 oveqd wa oveq2 oveq12 sylan2 adantr mpteq2dva rneqd
      vdwlema eqid ovex mptex rnex ovmpt2a 3adant1 eqtrd rnmpt syl6eq eleq2d id
      syl6eqel rexlimivw eqeq1 rexbidv elab3 oveq1 oveq2d eqeq2d cbvrexv syl6bb
      cvv bitri ) GUAMZCNMZBNMZUBZHCBGAUCZOZMHLPZCEPZBQOZROZSZEUDGUIUEOZUFOZTZL
      UGZMZHCFPZBQOZROZSZFWQTZWHWJWSHWHWJEWQWNUHZUJZWSWHWJCBIJNNEWQIPZWLJPZQOZR
      OZUHZUJZUKZOZXGWHWIXNCBWEWFWIXNSWGADEGIJKVAULUMWFWGXOXGSWEIJCBNNXMXGXNXHC
      SZXIBSZUNZXLXFXREWQXKWNXRXKWNSZWLWQMXQXPXJWMSXSXIBWLQUOXHCXJWMRUPUQURUSUT
      XNVBXFEWQWNUDWPUFVCVDVEVFVGVHELWQWNXFXFVBVIVJVKWTHWNSZEWQTZXEWRYALHXTHWCM
      EWQXTHWNWCXTVLCWMRVCVMVNWKHSWOXTEWQWKHWNVOVPVQXTXDEFWQWLXASZWNXCHYBWMXBCR
      WLXABQVRVSVTWAWDWB @.
      @( [18-Aug-2014] @)

    @( Change bound variables in the arithmetic progression function. @)
    vdwcbvap @p |- A = ( j e. NN0 |-> ( b e. NN , c e. NN |->
      ran ( n e. ( 0 ... ( j - 1 ) ) |-> ( b + ( n x. c ) ) ) ) ) @=
      ( cn cc0 cv c1 cmin co cfz cmpt crn cmpt2 wceq wcel nnex cmul caddc simp1
      cn0 w3a oveq1d oveq2d mpteq1 syl rneqd mpt2eq3dva mpt2ex fvmpt ) BDEFHHCI
      BJZKLMZNMZEJZCJFJZUAMUBMZOZPZQEFHHCIDKLMZNMZUSOZPZQUDAUNDRZEFHHVAVEVFUQHS
      ZURHSZUEZUTVDVIUPVCRUTVDRVIUOVBINVIUNDKLVFVGVHUCUFUGCUPVCUSUHUIUJUKGEFHHV
      ETTULUM @.
      @( [18-Aug-2014] @)

    @( Remove the first element of an arithmetic progression. @)
    vdwapun @p |- ( ( K e. NN0 /\ T e. NN /\ D e. NN ) ->
      ( T ( A ` ( K + 1 ) ) D ) = ( { T } u. ( ( T + D ) ( A ` K ) D ) ) ) @=
      ( vx cn wcel co cv cmul caddc wceq cc0 cfz w3a cfv cmin wrex cab cmpt crn
      c1 cmpt2 vdwlema 3ad2ant1 oveqd oveq2 oveq12 sylan2 adantr mpteq2dva eqid
      wa rneqd ovex mptex rnex ovmpt2a 3adant1 eqtrd rnmpt syl6eq eleq2d cvv id
      syl6eqel rexlimivw eqeq1 rexbidv elab3 syl6bb ) FLMZCLMZBLMZUAZGCBFAUBZNZ
      MGKOZCEOZBPNZQNZRZESFUHUCNZTNZUDZKUEZMGWGRZEWJUDZWAWCWLGWAWCEWJWGUFZUGZWL
      WAWCCBHILLEWJHOZWEIOZPNZQNZUFZUGZUIZNZWPWAWBXCCBVRVSWBXCRVTADEFHIJUJUKULV
      SVTXDWPRVRHICBLLXBWPXCWQCRZWRBRZUSZXAWOXGEWJWTWGXGWTWGRZWEWJMXFXEWSWFRXHW
      RBWEPUMWQCWSWFQUNUOUPUQUTXCURWOEWJWGSWITVAVBVCVDVEVFEKWJWGWOWOURVGVHVIWKW
      NKGWMGVJMEWJWMGWGVJWMVKCWFQVAVLVMWDGRWHWMEWJWDGWGVNVOVPVQ @.
      @( [18-Aug-2014] @)

    vdw.o @e |- O = { <. k , f >. |
      E. c ( ran ( A ` k ) i^i ~P ( `' f " { c } ) ) =/= (/) } @.
    @( Change bound variables in the "monochromatic" predicate. @)
    vdwcbvmc @p |- O = { <. j , g >. |
      E. s ( ran ( A ` j ) i^i ~P ( `' g " { s } ) ) =/= (/) } @=
      ( vz vu co wbr cfv crn ccnv cv csn cima cpw cin c0 wne wrex wss vdwlemd
      cn wcel wex wa elin vex anbi2i bitri exbii n0 df-rex 3bitr4i cxp wf wfn
      elpw wb vdwlemb syl ffn sseq1 rexrn 3syl cop fveq2 df-ov syl6eqr sseq1d
      wceq rexxp syl6bb syl5bb rexbidv bitrd ) AKJELMUFUGKDUHZUIZJUJPUKULUMZU
      NZUOZUPUQZPEURBUKZCUKZWOUFZWQUSZCVAURBVAURZPEURADEFGHIJKLMNOPQRSTUAUBUC
      UTAWTXEPEWTUDUKZWQUSZUDWPURZAXEXFWSVBZUDVCXFWPVBZXGVDZUDVCWTXHXIXKUDXIX
      JXFWRVBZVDXKXFWPWRVEXLXGXJXFWQUDVFVPVGVHVIUDWSVJXGUDWPVKVLAXHUEUKZWOUHZ
      WQUSZUEVAVAVMZURZXEAXPVAUNZWOVNZWOXPVOXHXQVQAKVAVBXSUBDGHKOQRVRVSXPXRWO
      VTXGXOUDUEXPWOXFXNWQWAWBWCXOXDUEBCVAVAXMXAXBWDZWIZXNXCWQYAXNXTWOUHXCXMX
      TWOWEXAXBWOWFWGWHWJWKWLWMWN @.
      @( [18-Aug-2014] @)

    @{
      vdwelmc.1 @e |- X e. _V @.
      vdwelmc.2 @e |- ( ph -> K e. NN ) @.
      vdwelmc.3 @e |- ( ph -> F : X --> Y ) @.
      @( The predicate " The ` <. R , N >. ` -coloring ` F ` contains a
         monochromatic AP of length ` K ` ".  @)
      vdwelmc @p |- ( ph -> ( K O F <-> E. c
          ( ran ( A ` K ) i^i ~P ( `' F " { c } ) ) =/= (/) ) ) @=
        ( co wbr cv cn wcel c1 cfz cmap wa cfv crn ccnv csn cima cpw cin c0 wne
        wrex copab cfn simpl simpr oveq2d oveq12d eleq2d anbi2d rexeqdv anbi12d
        wceq opabbidv nnex ovex xpex opabssxp ssexi ovmpt2a syl2anc breqd df-br
        cxp cop wb wf elmapg sylancl mpbird fveq2d rneqd cnveqd imaeq1d ineq12d
        cvv pweqd neeq1d rexbidv opelopab2a syl5bb bitrd ) AIHCJKUBZUCIHEUDZUEU
        FZDUDZCUGJUHUBZUIUBZUFZUJZXBBUKZULZXDUMZNUDUNZUOZUPZUQZURUSZNCUTZUJZEDV
        AZUCZIBUKZULZHUMZXLUOZUPZUQZURUSZNCUTZAXAXSIHACVBUFZJUEUFXAXSVKRSLGCJVB
        UEXCXDLUDZUGGUDZUHUBZUIUBZUFZUJZXPNYJUTZUJZEDVAXSKYJCVKZYKJVKZUJZYQXRED
        YTYOXHYPXQYTYNXGXCYTYMXFXDYTYJCYLXEUIYRYSVCZYTYKJUGUHYRYSVDVEVFVGVHYTXP
        NYJCUUAVIVJVLQXSUEXFWBUEXFVMCXEUIVNVOXQEDUEXFVPVQVRVSVTXTIHWCXSUFZAYHIH
        XSWAAIUEUFHXFUFZUUBYHWDTAUUCXECHWEZUAAYIXEWNUFUUCUUDWDRUGJUHVNCXEHVBWNW
        FWGWHXQYHEDIHUEXFXBIVKZXDHVKZUJZXPYGNCUUGXOYFURUUGXJYBXNYEUUGXIYAUUGXBI
        BUUEUUFVCWIWJUUGXMYDUUGXKYCXLUUGXDHUUEUUFVDWKWLWOWMWPWQWRVSWSWT @.
        @( [18-Aug-2014] @)

      @( Decompress the existence constraint hidden in ~ vdwlemd . @)
      vdwmc @p |- ( ph -> ( K O F <-> E. c E. x e. NN E. y e. NN
                    ( x ( A ` K ) y ) C_ ( `' F " { c } ) ) ) @=
        ( vz vu co wbr cfv crn ccnv cv csn cima cpw cin c0 wne wrex wss vdwlemd
        cn wcel wex wa elin vex anbi2i bitri exbii n0 df-rex 3bitr4i cxp wf wfn
        elpw wb vdwlemb syl ffn sseq1 rexrn 3syl cop fveq2 df-ov syl6eqr sseq1d
        wceq rexxp syl6bb syl5bb rexbidv bitrd ) AKJELMUFUGKDUHZUIZJUJPUKULUMZU
        NZUOZUPUQZPEURBUKZCUKZWOUFZWQUSZCVAURBVAURZPEURADEFGHIJKLMNOPQRSTUAUBUC
        UTAWTXEPEWTUDUKZWQUSZUDWPURZAXEXFWSVBZUDVCXFWPVBZXGVDZUDVCWTXHXIXKUDXIX
        JXFWRVBZVDXKXFWPWRVEXLXGXJXFWQUDVFVPVGVHVIUDWSVJXGUDWPVKVLAXHUEUKZWOUHZ
        WQUSZUEVAVAVMZURZXEAXPVAUNZWOVNZWOXPVOXHXQVQAKVAVBXSUBDGHKOQRVRVSXPXRWO
        VTXGXOUDUEXPWOXFXNWQWAWBWCXOXDUEBCVAVAXMXAXBWDZWIZXNXCWQYAXNXTWOUHXCXMX
        TWOWEXAXBWOWFWGWHWJWKWLWMWN @.
        @( [18-Aug-2014] @)
    @}

    vdw.p @e |- P = { <. <. m , k >. , f >. | E. a e. NN
      E. d e. ( NN ^m ( 1 ... m ) ) ( A. i e. ( 1 ... m )
      ( ( a + ( d ` i ) ) ( A ` k ) ( d ` i ) ) C_
        ( `' f " { ( f ` ( a + ( d ` i ) ) ) } ) /\
      ( # ` ran ( i e. ( 1 ... m ) |-> ( f ` ( a + ( d ` i ) ) ) ) ) = m ) } @.
    @( Change bound variables in the "polychromatic" predicate. @)
    vdwcbvpc @p |- P = { <. <. n , j >. , g >. | E. b e. NN
      E. s e. ( NN ^m ( 1 ... n ) ) ( A. l e. ( 1 ... n )
      ( ( b + ( s ` l ) ) ( A ` j ) ( s ` l ) ) C_
        ( `' g " { ( g ` ( b + ( s ` l ) ) ) } ) /\
      ( # ` ran ( l e. ( 1 ... n ) |-> ( g ` ( b + ( s ` l ) ) ) ) ) = n ) } @=
      ( vz vu co wbr cfv crn ccnv cv csn cima cpw cin c0 wne wrex wss vdwlemd
      cn wcel wex wa elin vex anbi2i bitri exbii n0 df-rex 3bitr4i cxp wf wfn
      elpw wb vdwlemb syl ffn sseq1 rexrn 3syl cop fveq2 df-ov syl6eqr sseq1d
      wceq rexxp syl6bb syl5bb rexbidv bitrd ) AKJELMUFUGKDUHZUIZJUJPUKULUMZU
      NZUOZUPUQZPEURBUKZCUKZWOUFZWQUSZCVAURBVAURZPEURADEFGHIJKLMNOPQRSTUAUBUC
      UTAWTXEPEWTUDUKZWQUSZUDWPURZAXEXFWSVBZUDVCXFWPVBZXGVDZUDVCWTXHXIXKUDXIX
      JXFWRVBZVDXKXFWPWRVEXLXGXJXFWQUDVFVPVGVHVIUDWSVJXGUDWPVKVLAXHUEUKZWOUHZ
      WQUSZUEVAVAVMZURZXEAXPVAUNZWOVNZWOXPVOXHXQVQAKVAVBXSUBDGHKOQRVRVSXPXRWO
      VTXGXOUDUEXPWOXFXNWQWAWBWCXOXDUEBCVAVAXMXAXBWDZWIZXNXCWQYAXNXTWOUHXCXMX
      TWOWEXAXBWOWFWGWHWJWKWLWMWN @.
      @( [18-Aug-2014] @)

    @{
      vdwpc.1 @e |- X e. _V @.
      vdwpc.2 @e |- ( ph -> K e. NN ) @.
      vdwpc.3 @e |- ( ph -> F : X --> Y ) @.
      vdwpc.4 @e |- ( ph -> M e. NN ) @.
      vdwpc.5 @e |- J = ( 1 ... M ) @.
      @( The predicate " The coloring ` F ` contains a
         polychromatic ` M ` -tuple of AP's of length ` K ` ".  A polychromatic
         ` M ` -tuple of AP's is a set of AP's with the same base point but
         different step lengths, such that each individual AP is monochromatic,
         but the AP's all have mutually distinct colors.  (The common basepoint
         is not required to have the same color as any of the AP's.) @)
      vdwp @p |- ( ph -> ( <. M , K >. P F <-> E. a e. NN
        E. d e. ( NN ^m J ) ( A. i e. J ( ( a + ( d ` i ) ) ( A ` K )
            ( d ` i ) ) C_ ( `' F " { ( F ` ( a + ( d ` i ) ) ) } ) /\
        ( # ` ran ( i e. J |-> ( F ` ( a + ( d ` i ) ) ) ) ) = M ) ) ) @=
        ( co cfv wbr cop wcel cv caddc ccnv csn cima wss wral cmpt crn chash wa
        wceq cn cmap wrex df-br cfz copab cfn simpl simpr oveq2d oveq12d eleq2d
        c1 anbi2d anbi1d opabbidv adantr mpteq2dva mptex ovmpt2a syl2anc fveq1d
        oveq2 syl6eqr raleqdv mpteq1 syl rneqd fveq2d id eqeq12d anbi12d syl5bb
        nnex rexeqbidv rexbidv eqid cxp ovex xpex opabssxp ssexi fvmpt eqtrd wb
        wf cvv elmapg sylancl mpbird oveqd cnveqd imaeq1d sneqd imaeq2d sseq12d
        ralbidv eqeq1d 2rexbidv opelopab2a bitrd ) MKNEODUKZULZUMMKUNZYJUOZARUP
        GUPZTUPULZUQUKZYNMCULZUKZKURZYOKULZUSZUTZVAZGLVBZGLYSVCZVDZVEULZNVGZVFZ
        TVHLVIUKZVJRVHVJZMKYJVKAYLYKHUPZVHUOZFUPZEVTOVLUKZVIUKZUOZVFZYOYNUUKCUL
        ZUKZUUMURZYOUUMULZUSZUTZVAZGLVBZGLUVAVCZVDZVEULZNVGZVFZTUUIVJZRVHVJZVFZ
        HFVMZUOZUUJAYJUVNYKAYJNIVHUUQBTVHVTIUPZVLUKZVIUKZVJZRVHVJZVFZHFVMZVCZUL
        ZUVNANYIUWCAEVNUOZOVHUOYIUWCVGUEUFQJEOVNVHIVHUULUUMQUPZVTJUPZVLUKZVIUKZ
        UOZVFZUVTVFZHFVMZVCUWCDUWFEVGZUWGOVGZVFZIVHUWMUWBUWPUWMUWBVGUVPVHUOUWPU
        WLUWAHFUWPUWKUUQUVTUWPUWJUUPUULUWPUWIUUOUUMUWPUWFEUWHUUNVIUWNUWOVOUWPUW
        GOVTVLUWNUWOVPVQVRVSWAWBWCWDWEUDIVHUWBXAWFWGWHWIANVHUOUWDUVNVGUIINUWBUV
        NVHUWCUVPNVGZUWAUVMHFUWQUVTUVLUUQUWQUVSUVKRVHUWQBUVJTUVRUUIUWQUVQLVHVIU
        WQUVQVTNVLUKLUVPNVTVLWJUJWKZVQBUVDGUVQVBZGUVQUVAVCZVDZVEULZUVPVGZVFUWQU
        VJUCUWQUWSUVEUXCUVIUWQUVDGUVQLUWRWLUWQUXBUVHUVPNUWQUXAUVGVEUWQUWTUVFUWQ
        UVQLVGUWTUVFVGUWRGUVQLUVAWMWNWOWPUWQWQWRWSWTXBXCWAWCUWCXDUVNVHUUOXEVHUU
        OXAEUUNVIXFXGUVLHFVHUUOXHXIXJWNXKVSAMVHUOKUUOUOZUVOUUJXLUGAUXDUUNEKXMZU
        HAUWEUUNXNUOUXDUXEXLUEVTOVLXFEUUNKVNXNXOXPXQUVLUUJHFMKVHUUOUUKMVGZUUMKV
        GZVFZUVJUUHRTVHUUIUXHUVEUUCUVIUUGUXHUVDUUBGLUXHUUSYQUVCUUAUXHUURYPYOYNU
        XHUUKMCUXFUXGVOWPXRUXHUVCYRUVBUTUUAUXHUUTYRUVBUXHUUMKUXFUXGVPZXSXTUXHUV
        BYTYRUXHUVAYSUXHYOUUMKUXIWIZYAYBXKYCYDUXHUVHUUFNUXHUVGUUEVEUXHUVFUUDUXH
        GLUVAYSUXHUVAYSVGYMLUOUXJWDWEWOWPYEWSYFYGWHYHWT @.
        @( [18-Aug-2014] @)
    @}

    vdw.r @e |- ( ph -> R e. Fin ) @.
    @{
      vdwlemk.1 @e |- ( ph -> K e. NN ) @.
      vdwlemk.3 @e |- ( ph -> W e. NN ) @.
      vdwlemk.4 @e |- ( ph -> F : ( 1 ... W ) --> R ) @.
      vdwlemk.5 @e |- ( ph -> T e. NN ) @.
      @{
        vdwlemo.2 @e |- ( ph -> M e. NN ) @.
        vdwlemo.6 @e |- ( ph -> D : ( 1 ... M ) --> NN ) @.
        vdwlemo.7 @e |- ( ph -> A. i e. ( 1 ... M )
          ( ( T + ( D ` i ) ) ( A ` K ) ( D ` i ) ) C_
          ( `' F " { ( F ` ( T + ( D ` i ) ) ) } ) ) @.
        vdwlemo.8 @e |- ( ph -> I e. ( 1 ... ( # ` R ) ) ) @.
        vdwlemo.9 @e |- ( ph ->
          ( F ` T ) = ( F ` ( T + ( D ` I ) ) ) ) @.
        @( Lemma for ~ vdw . @)
        vdwlemo @p |- ( ph -> ( K + 1 ) ( R O W ) F ) @=
          ? @.
      @}

      vdwlemk.2 @e |- ( ph -> ( # ` R ) e. NN ) @.
      vdwlemk.6 @e |- ( ph -> D : ( 1 ... ( # ` R ) ) --> NN ) @.
      vdwlemk.7 @e |- ( ph -> A. i e. ( 1 ... ( # ` R ) )
        ( ( T + ( D ` i ) ) ( A ` K ) ( D ` i ) ) C_
        ( `' F " { ( F ` ( T + ( D ` i ) ) ) } ) ) @.
      vdwlemk.8 @e |- G =
        ( i e. ( 1 ... ( # ` R ) ) |-> ( F ` ( T + ( D ` i ) ) ) ) @.
      vdwlemk.9 @e |- ( ph -> ( # ` ran G ) = ( # ` R ) ) @.
      @( Lemma for ~ vdw . @)
      vdwlemk @p |- ( ph -> ( K + 1 ) ( R O W ) F ) @=
        ( vx vy vz vw c1 chash cfv caddc co cfz csdm wbr clt cn0 wcel cr hashcl
        cfn syl nn0re ltp1 3syl wceq cn nn0p1nn nnnn0 hashfz1 breqtrrd hashsdom
        wb fzfi sylancl mpbid cdom wn wf1 wf cv wral elfznn nnre anim12i adantl
        wi eleq1 bi2anan9 fveq2 eqeqan12d eqeq12 imbi12d ancom syl6bb eqcom cle
        wa biidd idd c2 ad2antrr csn cima cpw cin wne wrex simplrr syl2anc cmin
        c0 cpr wo cmul cc0 2nn a1i simplrl syl3anc wsbc ax-1cn cz 0z ax-mp ovex
        oveq2d eqeq2d sbcie cc nncn eqtrd syl5bb vex wfn ffn fniniseg mpbir2and
        cvv impancom crn ccnv ffvelrn nnsub vdwlemc 2cn 1p1e2 subaddrii addid2i
        simprr eqtr4i oveq2i fzpr eqtri rexeq elexi rexpr bitri oveq1 addid1 id
        mul02 syl6eq oveq1d mulid2 orbi12d bitrd elpr syl6bbr eqrdv cxp vdwlemb
        pncan3 mp2b fnovrn eqeltrrd wss fvex simprl eqidd jca prss sylib sylibr
        prex elpw inelcm sneq imaeq2d ineq2d neeq1d rcla4ev vdwlemd mpbird expr
        pweqd jctird eqlelt sylibrd com23 3ad2antr3 wlogle mpd ralrimivva dff13
        mtod ex sylanbrc f1dom domnsym pm2.65i ) AEUHEUIUJZUHUKULZUMULZUNUOZAUX
        LUXNUIUJZUPUOZUXOAUXLUXMUXPUPAUXLUQURZUXLUSURUXLUXMUPUOAEVAURZUXRUAEUTZ
        VBUXLVCUXLVDVEAUXMUQURZUXPUXMVFAUXMVGURZUYAAUXSUYBUAUXSUXRUYBUXTUXLVHVB
        ZVBUXMVIVBUXMVJVBVKAUXSUXNVAURUXQUXOVMUAUHUXMVNEUXNVLVOVPAUXNEVQUOZUXOV
        RAUXNEKVSZUYDAUXNEKVTZUDWAZKUJZUEWAZKUJZVFZUYGUYIVFZWGZUEUXNWBUDUXNWBUY
        EUBAUYMUDUEUXNUXNAUYGUXNURZUYIUXNURZWRZWRZUYGUSURZUYIUSURZWRZUYMUYPUYTA
        UYNUYRUYOUYSUYNUYGVGURZUYRUYGUXMWCZUYGWDVBZUYOUYIVGURZUYSUYIUXMWCZUYIWD
        VBZWEWFAUYTUYPUYMAUFWAZUXNURZUGWAZUXNURZWRZVUGKUJZVUIKUJZVFZVUGVUIVFZWG
        ZWGUYPUYMWGZVUQUDUEUFUGVUGUYGVFZVUIUYIVFZWRZVUKUYPVUPUYMVURVUHUYNVUSVUJ
        UYOVUGUYGUXNWHVUIUYIUXNWHWIVUTVUNUYKVUOUYLVURVUSVULUYHVUMUYJVUGUYGKWJVU
        IUYIKWJWKVUGUYGVUIUYIWLWMWMVUGUYIVFZVUIUYGVFZWRZVUKUYPVUPUYMVVCVUKUYOUY
        NWRUYPVVAVUHUYOVVBVUJUYNVUGUYIUXNWHVUIUYGUXNWHWIUYOUYNWNWOVVCVUNUYKVUOU
        YLVVCVUNUYJUYHVFUYKVVAVVBVULUYJVUMUYHVUGUYIKWJVUIUYGKWJWKUYJUYHWPWOVVCV
        UOUYIUYGVFUYLVUGUYIVUIUYGWLUYIUYGWPWOWMWMAUYTWRVUQWSAUYRUYGUYIWQUOZVUQU
        YSAUYPVVDUYMUYQUYKVVDUYLUYQUYKVVDUYLWGUYQUYKWRZVVDVVDUYGUYIUPUOZVRZWRZU
        YLVVEVVDVVDVVGVVEVVDWTVVEVVFXAKEUXMLULUOZAVVIVRUYPUYKUCXBUYQUYKVVFVVIUY
        QUYKVVFWRZWRZVVIXACUJZUUAZKUUBZOWAZXCZXDZXEZXFZXLXGZOEXHZVVKUYJEURZVVMV
        VNUYJXCZXDZXEZXFZXLXGZVWAVVKUYFUYOVWBAUYFUYPVVJUBXBZAUYNUYOVVJXIZUXNEUY
        IKUUCXJVVKUYGUYIXMZVVMURVWJVWEURZVWGVVKUYGUYIUYGXKULZVVLULZVWJVVMVVKUFV
        WMVWJVVKVUGVWMURZVURVVAXNZVUGVWJURVVKVWNVUGUYGIWAZVWLXOULZUKULZVFZIXPXA
        UHXKULZUMULZXHZVWOVVKXAVGURZVUAVWLVGURZVWNVXBVMVXCVVKXQXRZVVKUYNVUAAUYN
        UYOVVJXSZVUBVBZVVKVVFVXDUYQUYKVVFUUJVVKVUAVUDVVFVXDVMVXGVVKUYOVUDVWIVUE
        VBZUYGUYIUUDXJVPZCVWLUYGHIXAVUGNPQUUEXTVXBVWSIXPYAZVWSIXPUHUKULZYAZXNZV
        VKVWOVXBVWSIXPVXKXMZXHZVXMVXAVXNVFVXBVXOVMVXAXPVXKUMULZVXNVWTVXKXPUMVWT
        UHVXKXAUHUHUUFYBYBUUGUUHUHYBUUIZUUKUULXPYCURVXPVXNVFYDXPUUMYEUUNVWSIVXA
        VXNUUOYEVWSIXPVXKXPYCYDUUPZXPUHUKYFZUUQUURVVKVXJVURVXLVVAVXJVUGUYGXPVWL
        XOULZUKULZVFZVVKVURVWSVYBIXPVXRVWPXPVFZVWRVYAVUGVYCVWQVXTUYGUKVWPXPVWLX
        OUUSYGYHYIVVKVYAUYGVUGVVKVYAUYGXPUKULZUYGVVKVXTXPUYGUKVVKVWLYJURZVXTXPV
        FVVKVXDVYEVXIVWLYKVBZVWLUVBVBYGVVKUYGYJURZVYDUYGVFVVKVUAVYGVXGUYGYKVBZU
        YGUUTVBYLYHYMVXLVUGUYGUHVWLXOULZUKULZVFZVVKVVAVWSVYKIVXKVXSVWPVXKVFZVWR
        VYJVUGVYLVWQVYIUYGUKVYLVWPUHVWLXOVYLVWPVXKUHVYLUVAVXQUVCUVDYGYHYIVVKVYJ
        UYIVUGVVKVYJUYGVWLUKULZUYIVVKVYIVWLUYGUKVVKVYEVYIVWLVFVYFVWLUVEVBYGVVKV
        YGUYIYJURZVYMUYIVFVYHVVKVUDVYNVXHUYIYKVBUYGUYIUVMXJYLYHYMUVFYMUVGVUGUYG
        UYIUFYNUVHUVIUVJVVKVVLVGVGUVKZYOZVUAVXDVWMVVMURVYPVVKVXCVYOVGXEZVVLVTVY
        PXQCHIXANPQUVLVYOVYQVVLYPUVNXRVXGVXIVGVGUYGVWLVVLUVOXTUVPVVKVWJVWDUVQZV
        WKVVKUYGVWDURZUYIVWDURZWRVYRVVKVYSVYTVVKVYSUYNUYKVVKKUXNYOZUYJYSURZVYSU
        YNUYKWRVMVVKUYFWUAVWHUXNEKYPVBZUYIKUVRZUXNUYJUYGKYSYQVOVXFUYQUYKVVFUVSY
        RVVKVYTUYOUYJUYJVFZVVKWUAWUBVYTUYOWUEWRVMWUCWUDUXNUYJUYIKYSYQVOVWIVVKUY
        JUVTYRUWAUYGUYIVWDUDYNUEYNUWBUWCVWJVWDUYGUYIUWEUWFUWDVWJVVMVWEUWGXJVVTV
        WGOUYJEVVOUYJVFZVVSVWFXLWUFVVRVWEVVMWUFVVQVWDWUFVVPVWCVVNVVOUYJUWHUWIUW
        PUWJUWKUWLXJVVKCEFHIJKXAUXMLMNOPQRAUXSUYPVVJUAXBZVVKUXSUYBWUGUYCVBVXEVW
        HUWMUWNUWOUXFUWQVVEUYRUYSUYLVVHVMVVEUYNUYRAUYNUYOUYKXSVUCVBVVEUYOUYSAUY
        NUYOUYKXIVUFVBUYGUYIUWRXJUWSUXGUWTYTUXAUXBYTUXCUXDUDUEUXNEKUXEUXHUXNEKU
        HUXMUMYFUXIVBUXNEUXJVBUXK @.
        @( [18-Aug-2014] @)
    @}

    @{
      vdwlemm.1 @e |- ( ph -> K e. ( ZZ>= ` 2 ) ) @.
      vdwlemm.2 @e |- ( ph -> W e. NN ) @.
      vdwlemm.3 @e |- ( ph -> F : ( 1 ... ( 2 x. W ) ) --> R ) @.
      vdwlemm.4 @e |- ( ph -> C e. R ) @.
      vdwlemm.5 @e |- ( ph -> T e. NN ) @.
      vdwlemm.6 @e |- ( ph -> D e. NN ) @.
      vdwlemm.7 @e |- ( ph -> ( T ( A ` K ) D ) C_ ( `' G " { C } ) ) @.
      vdwlemm.8 @e |- G = ( x e. ( 1 ... W ) |-> ( F ` ( x + W ) ) ) @.
      @( Lemma for ~ vdw . @)
      vdwlemm @p |- ( ph -> K ( ( R P ( 2 x. W ) ) ` 1 ) F ) @=
        ( vx vy vz vw c1 chash cfv caddc co cfz csdm wbr clt cn0 wcel cr hashcl
        cfn syl nn0re ltp1 3syl wceq cn nn0p1nn nnnn0 hashfz1 breqtrrd hashsdom
        wb fzfi sylancl mpbid cdom wn wf1 wf cv wral elfznn nnre anim12i adantl
        wi eleq1 bi2anan9 fveq2 eqeqan12d eqeq12 imbi12d ancom syl6bb eqcom cle
        wa biidd idd c2 ad2antrr csn cima cpw cin wne wrex simplrr syl2anc cmin
        c0 cpr wo cmul cc0 2nn a1i simplrl syl3anc wsbc ax-1cn cz 0z ax-mp ovex
        oveq2d eqeq2d sbcie cc nncn eqtrd syl5bb vex wfn ffn fniniseg mpbir2and
        cvv impancom crn ccnv ffvelrn nnsub vdwlemc 2cn 1p1e2 subaddrii addid2i
        simprr eqtr4i oveq2i fzpr eqtri rexeq elexi rexpr bitri oveq1 addid1 id
        mul02 syl6eq oveq1d mulid2 orbi12d bitrd elpr syl6bbr eqrdv cxp vdwlemb
        pncan3 mp2b fnovrn eqeltrrd wss fvex simprl eqidd jca prss sylib sylibr
        prex elpw inelcm sneq imaeq2d ineq2d neeq1d rcla4ev vdwlemd mpbird expr
        pweqd jctird eqlelt sylibrd com23 3ad2antr3 wlogle mpd ralrimivva dff13
        mtod ex sylanbrc f1dom domnsym pm2.65i ) AEUHEUIUJZUHUKULZUMULZUNUOZAUX
        LUXNUIUJZUPUOZUXOAUXLUXMUXPUPAUXLUQURZUXLUSURUXLUXMUPUOAEVAURZUXRUAEUTZ
        VBUXLVCUXLVDVEAUXMUQURZUXPUXMVFAUXMVGURZUYAAUXSUYBUAUXSUXRUYBUXTUXLVHVB
        ZVBUXMVIVBUXMVJVBVKAUXSUXNVAURUXQUXOVMUAUHUXMVNEUXNVLVOVPAUXNEVQUOZUXOV
        RAUXNEKVSZUYDAUXNEKVTZUDWAZKUJZUEWAZKUJZVFZUYGUYIVFZWGZUEUXNWBUDUXNWBUY
        EUBAUYMUDUEUXNUXNAUYGUXNURZUYIUXNURZWRZWRZUYGUSURZUYIUSURZWRZUYMUYPUYTA
        UYNUYRUYOUYSUYNUYGVGURZUYRUYGUXMWCZUYGWDVBZUYOUYIVGURZUYSUYIUXMWCZUYIWD
        VBZWEWFAUYTUYPUYMAUFWAZUXNURZUGWAZUXNURZWRZVUGKUJZVUIKUJZVFZVUGVUIVFZWG
        ZWGUYPUYMWGZVUQUDUEUFUGVUGUYGVFZVUIUYIVFZWRZVUKUYPVUPUYMVURVUHUYNVUSVUJ
        UYOVUGUYGUXNWHVUIUYIUXNWHWIVUTVUNUYKVUOUYLVURVUSVULUYHVUMUYJVUGUYGKWJVU
        IUYIKWJWKVUGUYGVUIUYIWLWMWMVUGUYIVFZVUIUYGVFZWRZVUKUYPVUPUYMVVCVUKUYOUY
        NWRUYPVVAVUHUYOVVBVUJUYNVUGUYIUXNWHVUIUYGUXNWHWIUYOUYNWNWOVVCVUNUYKVUOU
        YLVVCVUNUYJUYHVFUYKVVAVVBVULUYJVUMUYHVUGUYIKWJVUIUYGKWJWKUYJUYHWPWOVVCV
        UOUYIUYGVFUYLVUGUYIVUIUYGWLUYIUYGWPWOWMWMAUYTWRVUQWSAUYRUYGUYIWQUOZVUQU
        YSAUYPVVDUYMUYQUYKVVDUYLUYQUYKVVDUYLWGUYQUYKWRZVVDVVDUYGUYIUPUOZVRZWRZU
        YLVVEVVDVVDVVGVVEVVDWTVVEVVFXAKEUXMLULUOZAVVIVRUYPUYKUCXBUYQUYKVVFVVIUY
        QUYKVVFWRZWRZVVIXACUJZUUAZKUUBZOWAZXCZXDZXEZXFZXLXGZOEXHZVVKUYJEURZVVMV
        VNUYJXCZXDZXEZXFZXLXGZVWAVVKUYFUYOVWBAUYFUYPVVJUBXBZAUYNUYOVVJXIZUXNEUY
        IKUUCXJVVKUYGUYIXMZVVMURVWJVWEURZVWGVVKUYGUYIUYGXKULZVVLULZVWJVVMVVKUFV
        WMVWJVVKVUGVWMURZVURVVAXNZVUGVWJURVVKVWNVUGUYGIWAZVWLXOULZUKULZVFZIXPXA
        UHXKULZUMULZXHZVWOVVKXAVGURZVUAVWLVGURZVWNVXBVMVXCVVKXQXRZVVKUYNVUAAUYN
        UYOVVJXSZVUBVBZVVKVVFVXDUYQUYKVVFUUJVVKVUAVUDVVFVXDVMVXGVVKUYOVUDVWIVUE
        VBZUYGUYIUUDXJVPZCVWLUYGHIXAVUGNPQUUEXTVXBVWSIXPYAZVWSIXPUHUKULZYAZXNZV
        VKVWOVXBVWSIXPVXKXMZXHZVXMVXAVXNVFVXBVXOVMVXAXPVXKUMULZVXNVWTVXKXPUMVWT
        UHVXKXAUHUHUUFYBYBUUGUUHUHYBUUIZUUKUULXPYCURVXPVXNVFYDXPUUMYEUUNVWSIVXA
        VXNUUOYEVWSIXPVXKXPYCYDUUPZXPUHUKYFZUUQUURVVKVXJVURVXLVVAVXJVUGUYGXPVWL
        XOULZUKULZVFZVVKVURVWSVYBIXPVXRVWPXPVFZVWRVYAVUGVYCVWQVXTUYGUKVWPXPVWLX
        OUUSYGYHYIVVKVYAUYGVUGVVKVYAUYGXPUKULZUYGVVKVXTXPUYGUKVVKVWLYJURZVXTXPV
        FVVKVXDVYEVXIVWLYKVBZVWLUVBVBYGVVKUYGYJURZVYDUYGVFVVKVUAVYGVXGUYGYKVBZU
        YGUUTVBYLYHYMVXLVUGUYGUHVWLXOULZUKULZVFZVVKVVAVWSVYKIVXKVXSVWPVXKVFZVWR
        VYJVUGVYLVWQVYIUYGUKVYLVWPUHVWLXOVYLVWPVXKUHVYLUVAVXQUVCUVDYGYHYIVVKVYJ
        UYIVUGVVKVYJUYGVWLUKULZUYIVVKVYIVWLUYGUKVVKVYEVYIVWLVFVYFVWLUVEVBYGVVKV
        YGUYIYJURZVYMUYIVFVYHVVKVUDVYNVXHUYIYKVBUYGUYIUVMXJYLYHYMUVFYMUVGVUGUYG
        UYIUFYNUVHUVIUVJVVKVVLVGVGUVKZYOZVUAVXDVWMVVMURVYPVVKVXCVYOVGXEZVVLVTVY
        PXQCHIXANPQUVLVYOVYQVVLYPUVNXRVXGVXIVGVGUYGVWLVVLUVOXTUVPVVKVWJVWDUVQZV
        WKVVKUYGVWDURZUYIVWDURZWRVYRVVKVYSVYTVVKVYSUYNUYKVVKKUXNYOZUYJYSURZVYSU
        YNUYKWRVMVVKUYFWUAVWHUXNEKYPVBZUYIKUVRZUXNUYJUYGKYSYQVOVXFUYQUYKVVFUVSY
        RVVKVYTUYOUYJUYJVFZVVKWUAWUBVYTUYOWUEWRVMWUCWUDUXNUYJUYIKYSYQVOVWIVVKUY
        JUVTYRUWAUYGUYIVWDUDYNUEYNUWBUWCVWJVWDUYGUYIUWEUWFUWDVWJVVMVWEUWGXJVVTV
        WGOUYJEVVOUYJVFZVVSVWFXLWUFVVRVWEVVMWUFVVQVWDWUFVVPVWCVVNVVOUYJUWHUWIUW
        PUWJUWKUWLXJVVKCEFHIJKXAUXMLMNOPQRAUXSUYPVVJUAXBZVVKUXSUYBWUGUYCVBVXEVW
        HUWMUWNUWOUXFUWQVVEUYRUYSUYLVVHVMVVEUYNUYRAUYNUYOUYKXSVUCVBVVEUYOUYSAUY
        NUYOUYKXIVUFVBUYGUYIUWRXJUWSUXGUWTYTUXAUXBYTUXCUXDUDUEUXNEKUXEUXHUXNEKU
        HUXMUMYFUXIVBUXNEUXJVBUXK @.
        @( [18-Aug-2014] @)
    @}

    @{
      vdwlemf.1 @e |- ( ph -> K e. ( ZZ>= ` 2 ) ) @.
      vdwlemf.2 @e |- ( ph -> A. s e. Fin E. n e. NN
        A. f e. ( s ^m ( 1 ... n ) ) K ( s O n ) f ) @.
      @{
        vdwlemi.3 @e |- ( ph -> M e. NN ) @.
        vdwlemi.4 @e |- ( ph -> W e. NN ) @.
        vdwlemi.5 @e |- ( ph -> A. g e. ( R ^m ( 1 ... W ) )
          ( K ( ( R P W ) ` M ) g \/ ( K + 1 ) ( R O W ) g ) ) @.
        vdwlemi.6 @e |- ( ph -> V e. NN ) @.
        vdwlemi.7 @e |- ( ph -> A. f e. ( ( R ^m ( 1 ... W ) ) ^m ( 1 ... V ) )
          K ( ( R ^m ( 1 ... W ) ) O V ) f ) @.
        vdwlemi.8 @e |- F = ( x e. ( 1 ... V ) |-> ( y e. ( 1 ... W ) |->
          ( h ` ( y + ( W x. ( ( x - 1 ) + V ) ) ) ) ) ) @.
        @( Lemma for ~ vdw . @)
        vdwlemi @p |- ( ph -> E. n e. NN A. h e. ( R ^m ( 1 ... n ) )
          ( K ( ( R P n ) ` ( M + 1 ) ) h \/ ( K + 1 ) ( R O n ) h ) ) @=
          ( vx vw vg vz vu vv vy cn wcel cv co cfv wbr caddc cfz cmap wral wrex
          c1 wo wi wceq fveq2 breqd orbi1d ralbidv rexbidv imbi2d cfn raleqbidv
          oveq1 rcla4v sylc oveq2 oveq2d cbvrexv sylib wa breq2 cbvralv c2 cmul
          wf cvv wb adantr ovex elmapg sylancl biimpa simplr cle elfzle2 adantl
          cmpt cr elfznn nnre syl simpr ad2antrr leadd1 syl3anc mpbid cc 2times
          breqtrrd cuz cz simpllr nnaddcl syl2anc nnuz syl6eleq nnmulcl sylancr
          2nn nnz eqid syldan cpw wss wex syl5bb simprll simprlr expr rexlimdva
          recnd sylbid fveq1d orbi12d syl5bi mpd elfz5 mpbird ffvelrn fmptd crn
          biimpar ccnv csn cima cin c0 wne clt eluz2b2 simplbi vdwlemd elin vex
          elpw anbi2i bitri exbii n0 df-rex 3bitr4i cxp wfn vdwlemb sseq1 rexrn
          ffn 3syl cop df-ov syl6eqr sseq1d rexxp syl6bb simprr orcd rexlimdvva
          vdwlemm syld ralrimdva jctild rcla4ev syl6 fzfi mapfi simprrl simprrr
          cmin vdwlemi anassrs expcom a2d nnind mpcom ) LUNUOAKFUPZLEJUPZDUQZUR
          ZUSZKVEUTUQZUWSEUWTMUQZUSZVFZFEVEUWTVAUQZVBUQZVCZJUNVDZUFAKUWSUGUPZUX
          AURZUSZUXFVFZFUXIVCZJUNVDZVGAKUWSVEUXAURZUSZUXFVFZFUXIVCZJUNVDZVGAKUW
          SIUPZUXAURZUSZUXFVFZFUXIVCZJUNVDZVGAKUWSUYCVEUTUQZUXAURZUSZUXFVFZFUXI
          VCZJUNVDZVGAUXKVGUGILUXLVEVHZUXQUYBAUYOUXPUYAJUNUYOUXOUXTFUXIUYOUXNUX
          SUXFUYOUXMUXRKUWSUXLVEUXAVIVJVKVLVMVNUXLUYCVHZUXQUYHAUYPUXPUYGJUNUYPU
          XOUYFFUXIUYPUXNUYEUXFUYPUXMUYDKUWSUXLUYCUXAVIVJVKVLVMVNUXLUYIVHZUXQUY
          NAUYQUXPUYMJUNUYQUXOUYLFUXIUYQUXNUYKUXFUYQUXMUYJKUWSUXLUYIUXAVIVJVKVL
          VMVNUXLLVHZUXQUXKAUYRUXPUXJJUNUYRUXOUXGFUXIUYRUXNUXCUXFUYRUXMUXBKUWSU
          XLLUXAVIVJVKVLVMVNAKUWSEUHUPZMUQZUSZFEVEUYSVAUQZVBUQZVCZUHUNVDZUYBAKU
          WSUXEUSZFUXIVCZJUNVDZVUEAEVOUOZKUWSNUPZUWTMUQZUSZFVUJUXHVBUQZVCZJUNVD
          ZNVOVCZVUHUCUEVUOVUHNEVOVUJEVHZVUNVUGJUNVUQVULVUFFVUMUXIVUJEUXHVBVQVU
          QVUKUXEKUWSVUJEUWTMVQVJVPVMVRVSVUGVUDJUHUNUWTUYSVHZVUFVUAFUXIVUCVURUX
          HVUBEVBUWTUYSVEVAVTWAZVURUXEUYTKUWSUWTUYSEMVTZVJVPWBWCAVUDUYBUHUNVUDK
          UIUPZUYTUSZUIVUCVCZAUYSUNUOZWDZUYBVUAVVBFUIVUCUWSVVAKUYTWEWFVVEVVCWGU
          YSWHUQZUNUOZKUWSVEEVVFDUQZURZUSZUXDUWSEVVFMUQZUSZVFZFEVEVVFVAUQZVBUQZ
          VCZWDUYBVVEVVCVVPVVGVVEVVCVVMFVVOVVEUWSVVOUOZVVNEUWSWIZVVCVVMVGVVEVVQ
          VVRVVEVUIVVNWJUOVVQVVRWKAVUIVVDUCWLZVEVVFVAWMEVVNUWSVOWJWNWOWPVVEVVRW
          DZVVCKUGVUBUXLUYSUTUQZUWSURZXAZUYTUSZVVMVVTVWCVUCUOZVVCVWDVGVVEVVRVUB
          EVWCWIZVWEVVTUGVUBVWBEVWCVVTUXLVUBUOZWDZVVRVWAVVNUOZVWBEUOVVEVVRVWGWQ
          VWHVWIVWAVVFWRUSZVWHVWAUYSUYSUTUQZVVFWRVWHUXLUYSWRUSZVWAVWKWRUSZVWGVW
          LVVTUXLVEUYSWSWTVWHUXLXBUOZUYSXBUOZVWOVWLVWMWKVWHUXLUNUOZVWNVWGVWPVVT
          UXLUYSXCWTZUXLXDXEVWHVVDVWOVVEVVDVVRVWGAVVDXFZXGUYSXDXEZVWSUXLUYSUYSX
          HXIXJVWHUYSXKUOVVFVWKVHVWHUYSVWSYOUYSXLXEXMVWHVWAVEXNURZUOVVFXOUOZVWI
          VWJWKVWHVWAUNVWTVWHVWPVVDVWAUNUOVWQAVVDVVRVWGXPUXLUYSXQXRXSXTVWHVVGVX
          AVVEVVGVVRVWGVVEWGUNUOVVDVVGYCVWRWGUYSYAYBZXGVVFYDXEVWAVEVVFUUAXRUUBV
          VNEVWAUWSUUCXRVWCYEZUUDZVVEVWEVWFVVEVUIVUBWJUOVWEVWFWKVVSVEUYSVAWMEVU
          BVWCVOWJWNWOUUFYFVVBVWDUIVWCVUCVVAVWCKUYTWEVRXEVVTVWDKCURZUUEZVWCUUGQ
          UPZUUHUUIZYGZUUJZUUKUULZQEVDVVMVVTCEFHIJVWCKUYSMOPQRSTVVEVUIVVRVVSWLZ
          VVEVVDVVRVWRWLZAKUNUOZVVDVVRAKWGXNURUOZVXNUDVXOVXNVEKUUMUSKUUNUUOXEXG
          ZVXDUUPVVTVXKVVMQEVVTVXGEUOZWDZVXKPUPZRUPZVXEUQZVXHYHZRUNVDPUNVDZVVMV
          XKUJUPZVXHYHZUJVXFVDZVXRVYCVYDVXJUOZUJYIVYDVXFUOZVYEWDZUJYIVXKVYFVYGV
          YIUJVYGVYHVYDVXIUOZWDVYIVYDVXFVXIUUQVYJVYEVYHVYDVXHUJUURUUSUUTUVAUVBU
          JVXJUVCVYEUJVXFUVDUVEVXRVYFUKUPZVXEURZVXHYHZUKUNUNUVFZVDZVYCVXRVYNUNY
          GZVXEWIZVXEVYNUVGVYFVYOWKVXRVXNVYQVVTVXNVXQVXPWLCHIKPRSUVHXEVYNVYPVXE
          UVKVYEVYMUJUKVYNVXEVYDVYLVXHUVIUVJUVLVYMVYBUKPRUNUNVYKVXSVXTUVMZVHZVY
          LVYAVXHVYSVYLVYRVXEURVYAVYKVYRVXEVIVXSVXTVXEUVNUVOUVPUVQUVRYJVXRVYBVV
          MPRUNUNVXRVXSUNUOZVXTUNUOZWDZVYBVVMVXRWUBVYBWDZWDZVVJVVLWUDBUGCVXGVXT
          DEVXSFGHIJUWSVWCKMUYSOPQRSTUAUBVVTVUIVXQWUCVXLXGVVTVXOVXQWUCAVXOVVDVV
          RUDXGXGVVTVVDVXQWUCVXMXGVVEVVRVXQWUCXPVVTVXQWUCWQVXRVYTWUAVYBYKVXRVYT
          WUAVYBYLVXRWUBVYBUVSVXCUWBUVTYMUWAYPYNYPUWCYFUWDVXBUWEUYAVVPJVVFUNUWT
          VVFVHZUXTVVMFUXIVVOWUEUXHVVNEVBUWTVVFVEVAVTWAWUEUXSVVJUXFVVLWUEUXRVVI
          KUWSWUEVEUXAVVHUWTVVFEDVTYQVJWUEUXEVVKUXDUWSUWTVVFEMVTVJYRVPUWFUWGYSY
          NYTUYCUNUOZAUYHUYNAWUFUYHUYNVGUYHKVVAUYCEUYSDUQZURZUSZUXDVVAUYTUSZVFZ
          UIVUCVCZUHUNVDAWUFWDZUYNUYGWULJUHUNUYGKVVAUYDUSZUXDVVAUXEUSZVFZUIUXIV
          CVURWULUYFWUPFUIUXIUWSVVAVHUYEWUNUXFWUOUWSVVAKUYDWEUWSVVAUXDUXEWEYRWF
          VURWUPWUKUIUXIVUCVUSVURWUNWUIWUOWUJVURUYDWUHKVVAVURUYCUXAWUGUWTUYSEDV
          TYQVJVURUXEUYTUXDVVAVUTVJYRVPYJWBWUMWULUYNUHUNWUMVVDWULUYNWUMVVDWULWD
          ZWDZKUWSVUCULUPZMUQZUSZFVUCVEWUSVAUQZVBUQZVCZULUNVDZUYNWURVUCVOUOZVUP
          WVEWURVUIVUBVOUOWVFAVUIWUFWUQUCXGVEUYSUWHEVUBUWIWOAVUPWUFWUQUEXGVUOWV
          ENVUCVOVUOKUWSVUJWUSMUQZUSZFVUJWVBVBUQZVCZULUNVDVUJVUCVHZWVEVUNWVJJUL
          UNUWTWUSVHZVULWVHFVUMWVIWVLUXHWVBVUJVBUWTWUSVEVAVTWAWVLVUKWVGKUWSUWTW
          USVUJMVTVJVPWBWVKWVJWVDULUNWVKWVHWVAFWVIWVCVUJVUCWVBVBVQWVKWVGWUTKUWS
          VUJVUCWUSMVQVJVPVMYJVRVSWURWVDUYNULUNWURWUSUNUOZWVDUYNWUMWUQWVMWVDWDZ
          UYNWUMWUQWVNWDZWDBUGUMCDEFUIFGHIJUGWVBUMVUBUMUPUYSUXLVEUWLUQWUSUTUQWH
          UQUTUQUWSURXAXAZKUYCMWUSUYSNOPQRSTUAUBAVUIWUFWVOUCXGAVXOWUFWVOUDXGAVU
          PWUFWVOUEXGAWUFWVOWQWUMVVDWULWVNYKWUMVVDWULWVNYLWUMWUQWVMWVDUWJWUMWUQ
          WVMWVDUWKWVPYEUWMUWNYMYNYTYMYNYSUWOUWPUWQUWR @.
          @( [20-Aug-2014] @)
      @}

      @{
        vdwlemh.3 @e |- ( ph -> M e. NN ) @.
        @( Lemma for ~ vdw .  Set up secondary induction on ` M ` . @)
        vdwlemh @p |- ( ph -> E. n e. NN A. f e. ( R ^m ( 1 ... n ) )
          ( K ( ( R P n ) ` M ) f \/ ( K + 1 ) ( R O n ) f ) ) @=
          ( vx vw vg vz vu vv cn wcel cv co cfv wbr c1 caddc cfz cmap wral wrex
          wo wceq fveq2 breqd orbi1d ralbidv rexbidv imbi2d cfn oveq1 raleqbidv
          wi rcla4v sylc oveq2 oveq2d cbvrexv sylib wa breq2 cbvralv c2 cmul wf
          cvv wb adantr ovex elmapg sylancl biimpa simplr cle elfzle2 adantl cr
          cmpt elfznn nnre syl simpr ad2antrr leadd1 syl3anc mpbid recnd 2times
          cc breqtrrd cuz simpllr nnaddcl syl2anc nnuz syl6eleq nnmulcl sylancr
          2nn nnz elfz5 mpbird syldan cpw wss wex syl5bb simprll simprlr sylbid
          cz expr rexlimdva fveq1d orbi12d syl5bi mpd ffvelrn fmptd biimpar crn
          eqid ccnv csn cima cin c0 wne clt eluz2b2 simplbi vdwlemd elin anbi2i
          vex elpw bitri exbii n0 df-rex 3bitr4i cxp wfn vdwlemb ffn sseq1 3syl
          rexrn cop df-ov syl6eqr sseq1d rexxp syl6bb simprr vdwlemm rexlimdvva
          orcd syld ralrimdva jctild rcla4ev syl6 mapfi simprrl simprrr vdwlemi
          fzfi anassrs expcom a2d nnind mpcom ) LUMUNAKFUOZLEJUOZDUPZUQZURZKUSU
          TUPZUWQEUWRMUPZURZVEZFEUSUWRVAUPZVBUPZVCZJUMVDZUFAKUWQUGUOZUWSUQZURZU
          XDVEZFUXGVCZJUMVDZVPAKUWQUSUWSUQZURZUXDVEZFUXGVCZJUMVDZVPAKUWQIUOZUWS
          UQZURZUXDVEZFUXGVCZJUMVDZVPAKUWQUYAUSUTUPZUWSUQZURZUXDVEZFUXGVCZJUMVD
          ZVPAUXIVPUGILUXJUSVFZUXOUXTAUYMUXNUXSJUMUYMUXMUXRFUXGUYMUXLUXQUXDUYMU
          XKUXPKUWQUXJUSUWSVGVHVIVJVKVLUXJUYAVFZUXOUYFAUYNUXNUYEJUMUYNUXMUYDFUX
          GUYNUXLUYCUXDUYNUXKUYBKUWQUXJUYAUWSVGVHVIVJVKVLUXJUYGVFZUXOUYLAUYOUXN
          UYKJUMUYOUXMUYJFUXGUYOUXLUYIUXDUYOUXKUYHKUWQUXJUYGUWSVGVHVIVJVKVLUXJL
          VFZUXOUXIAUYPUXNUXHJUMUYPUXMUXEFUXGUYPUXLUXAUXDUYPUXKUWTKUWQUXJLUWSVG
          VHVIVJVKVLAKUWQEUHUOZMUPZURZFEUSUYQVAUPZVBUPZVCZUHUMVDZUXTAKUWQUXCURZ
          FUXGVCZJUMVDZVUCAEVMUNZKUWQNUOZUWRMUPZURZFVUHUXFVBUPZVCZJUMVDZNVMVCZV
          UFUCUEVUMVUFNEVMVUHEVFZVULVUEJUMVUOVUJVUDFVUKUXGVUHEUXFVBVNVUOVUIUXCK
          UWQVUHEUWRMVNVHVOVKVQVRVUEVUBJUHUMUWRUYQVFZVUDUYSFUXGVUAVUPUXFUYTEVBU
          WRUYQUSVAVSVTZVUPUXCUYRKUWQUWRUYQEMVSZVHVOWAWBAVUBUXTUHUMVUBKUIUOZUYR
          URZUIVUAVCZAUYQUMUNZWCZUXTUYSVUTFUIVUAUWQVUSKUYRWDWEVVCVVAWFUYQWGUPZU
          MUNZKUWQUSEVVDDUPZUQZURZUXBUWQEVVDMUPZURZVEZFEUSVVDVAUPZVBUPZVCZWCUXT
          VVCVVAVVNVVEVVCVVAVVKFVVMVVCUWQVVMUNZVVLEUWQWHZVVAVVKVPVVCVVOVVPVVCVU
          GVVLWIUNVVOVVPWJAVUGVVBUCWKZUSVVDVAWLEVVLUWQVMWIWMWNWOVVCVVPWCZVVAKUG
          UYTUXJUYQUTUPZUWQUQZXAZUYRURZVVKVVRVWAVUAUNZVVAVWBVPVVCVVPUYTEVWAWHZV
          WCVVRUGUYTVVTEVWAVVRUXJUYTUNZWCZVVPVVSVVLUNZVVTEUNVVCVVPVWEWPVWFVWGVV
          SVVDWQURZVWFVVSUYQUYQUTUPZVVDWQVWFUXJUYQWQURZVVSVWIWQURZVWEVWJVVRUXJU
          SUYQWRWSVWFUXJWTUNZUYQWTUNZVWMVWJVWKWJVWFUXJUMUNZVWLVWEVWNVVRUXJUYQXB
          WSZUXJXCXDVWFVVBVWMVVCVVBVVPVWEAVVBXEZXFUYQXCXDZVWQUXJUYQUYQXGXHXIVWF
          UYQXLUNVVDVWIVFVWFUYQVWQXJUYQXKXDXMVWFVVSUSXNUQZUNVVDYNUNZVWGVWHWJVWF
          VVSUMVWRVWFVWNVVBVVSUMUNVWOAVVBVVPVWEXOUXJUYQXPXQXRXSVWFVVEVWSVVCVVEV
          VPVWEVVCWFUMUNVVBVVEYBVWPWFUYQXTYAZXFVVDYCXDVVSUSVVDYDXQYEVVLEVVSUWQU
          UAXQVWAUUEZUUBZVVCVWCVWDVVCVUGUYTWIUNVWCVWDWJVVQUSUYQVAWLEUYTVWAVMWIW
          MWNUUCYFVUTVWBUIVWAVUAVUSVWAKUYRWDVQXDVVRVWBKCUQZUUDZVWAUUFQUOZUUGUUH
          ZYGZUUIZUUJUUKZQEVDVVKVVRCEFHIJVWAKUYQMOPQRSTVVCVUGVVPVVQWKZVVCVVBVVP
          VWPWKZAKUMUNZVVBVVPAKWFXNUQUNZVXLUDVXMVXLUSKUULURKUUMUUNXDXFZVXBUUOVV
          RVXIVVKQEVVRVXEEUNZWCZVXIPUOZRUOZVXCUPZVXFYHZRUMVDPUMVDZVVKVXIUJUOZVX
          FYHZUJVXDVDZVXPVYAVYBVXHUNZUJYIVYBVXDUNZVYCWCZUJYIVXIVYDVYEVYGUJVYEVY
          FVYBVXGUNZWCVYGVYBVXDVXGUUPVYHVYCVYFVYBVXFUJUURUUSUUQUUTUVAUJVXHUVBVY
          CUJVXDUVCUVDVXPVYDUKUOZVXCUQZVXFYHZUKUMUMUVEZVDZVYAVXPVYLUMYGZVXCWHZV
          XCVYLUVFVYDVYMWJVXPVXLVYOVVRVXLVXOVXNWKCHIKPRSUVGXDVYLVYNVXCUVHVYCVYK
          UJUKVYLVXCVYBVYJVXFUVIUVKUVJVYKVXTUKPRUMUMVYIVXQVXRUVLZVFZVYJVXSVXFVY
          QVYJVYPVXCUQVXSVYIVYPVXCVGVXQVXRVXCUVMUVNUVOUVPUVQYJVXPVXTVVKPRUMUMVX
          PVXQUMUNZVXRUMUNZWCZVXTVVKVXPVYTVXTWCZWCZVVHVVJWUBBUGCVXEVXRDEVXQFGHI
          JUWQVWAKMUYQOPQRSTUAUBVVRVUGVXOWUAVXJXFVVRVXMVXOWUAAVXMVVBVVPUDXFXFVV
          RVVBVXOWUAVXKXFVVCVVPVXOWUAXOVVRVXOWUAWPVXPVYRVYSVXTYKVXPVYRVYSVXTYLV
          XPVYTVXTUVRVXAUVSUWAYOUVTYMYPYMUWBYFUWCVWTUWDUXSVVNJVVDUMUWRVVDVFZUXR
          VVKFUXGVVMWUCUXFVVLEVBUWRVVDUSVAVSVTWUCUXQVVHUXDVVJWUCUXPVVGKUWQWUCUS
          UWSVVFUWRVVDEDVSYQVHWUCUXCVVIUXBUWQUWRVVDEMVSVHYRVOUWEUWFYSYPYTUYAUMU
          NZAUYFUYLAWUDUYFUYLVPUYFKVUSUYAEUYQDUPZUQZURZUXBVUSUYRURZVEZUIVUAVCZU
          HUMVDAWUDWCZUYLUYEWUJJUHUMUYEKVUSUYBURZUXBVUSUXCURZVEZUIUXGVCVUPWUJUY
          DWUNFUIUXGUWQVUSVFUYCWULUXDWUMUWQVUSKUYBWDUWQVUSUXBUXCWDYRWEVUPWUNWUI
          UIUXGVUAVUQVUPWULWUGWUMWUHVUPUYBWUFKVUSVUPUYAUWSWUEUWRUYQEDVSYQVHVUPU
          XCUYRUXBVUSVURVHYRVOYJWAWUKWUJUYLUHUMWUKVVBWUJUYLWUKVVBWUJWCZWCZKUWQV
          UAULUOZMUPZURZFVUAUSWUQVAUPZVBUPZVCZULUMVDZUYLWUPVUAVMUNZVUNWVCWUPVUG
          UYTVMUNWVDAVUGWUDWUOUCXFUSUYQUWKEUYTUWGWNAVUNWUDWUOUEXFVUMWVCNVUAVMVU
          MKUWQVUHWUQMUPZURZFVUHWUTVBUPZVCZULUMVDVUHVUAVFZWVCVULWVHJULUMUWRWUQV
          FZVUJWVFFVUKWVGWVJUXFWUTVUHVBUWRWUQUSVAVSVTWVJVUIWVEKUWQUWRWUQVUHMVSV
          HVOWAWVIWVHWVBULUMWVIWVFWUSFWVGWVAVUHVUAWUTVBVNWVIWVEWURKUWQVUHVUAWUQ
          MVNVHVOVKYJVQVRWUPWVBUYLULUMWUPWUQUMUNZWVBUYLWUKWUOWVKWVBWCZUYLWUKWUO
          WVLWCZWCBCDEFUIFGHIJKUYAMWUQUYQNOPQRSTUAUBAVUGWUDWVMUCXFAVXMWUDWVMUDX
          FAVUNWUDWVMUEXFAWUDWVMWPWUKVVBWUJWVLYKWUKVVBWUJWVLYLWUKWUOWVKWVBUWHWU
          KWUOWVKWVBUWIUWJUWLYOYPYTYOYPYSUWMUWNUWOUWP @.
          @( [18-Aug-2014] @)
      @}

      @( Lemma for ~ vdw . @)
      vdwlemf @p |- ( ph -> E. n e. NN
        A. f e. ( R ^m ( 1 ... n ) ) ( K + 1 ) ( R O n ) f ) @=
        ( chash cfv cn wcel cc0 wceq wo c1 caddc wbr cfz cmap wral wrex cn0 cfn
        co cv hashcl syl elnn0 sylib wa adantr c2 cuz simpr vdwlemh wf cvv ovex
        wi elmapg sylancl ad2antrr biimpa w3a ccnv csn cima wss cmpt crn simpr2
        wb clt eluz2b2 simplbi simpr3 simpr1 eqid vdwleme simprll simprlr elmap
        nnex simprrl simprrr expr rexlimdvva sylbid idd jaod 3exp2 imp41 syldan
        vdwlemk ralimdva reximdva mpd c0 1nn wne cz elfz3 ax-mp oveq2 syl5eleqr
        ne0i map0b raleqdv ral0 2th syl6bb rcla4ev mp2an hasheq0 rexbidv mpbiri
        1z oveq1 jaodan mpdan ) AEUEUFZUGUHZYRUIUJZUKZKULUMVAFVBZEJVBZLVAUNZFEU
        LUUCUOVAZUPVAZUQZJUGURZAYRUSUHZUUAAEUTUHZUUIUBEVCVDYRVEVFAYSUUHYTAYSVGZ
        KUUBYREUUCDVAUFUNZUUDUKZFUUFUQZJUGURUUHUUKBCDEFGHIJKYRLMNOPQRSTUAAUUJYS
        UBVHAKVIVJUFUHZYSUCVHAKUUBMVBZUUCLVAUNFUUPUUEUPVAUQJUGURMUTUQYSUDVHAYSV
        KVLUUKUUNUUGJUGUUKUUCUGUHZVGZUUMUUDFUUFUURUUBUUFUHZUUEEUUBVMZUUMUUDVPZU
        URUUSUUTAUUSUUTWIZYSUUQAUUJUUEVNUHUVBUBULUUCUOVOZEUUEUUBUTVNVQVRVSVTAYS
        UUQUUTUVAAYSUUQUUTUVAAYSUUQUUTWAZVGZUULUUDUUDUVEUULOVBZGVBQVBZUFZUMVAZU
        VHKCUFVAUUBWBUVIUUBUFZWCWDWEGULYRUOVAZUQZGUVKUVJWFZWGUEUFYRUJZVGZQUGUVK
        UPVAZUROUGURUUDUVEBCDEFGHIJUUBUVKKYRUUCLNOPQRSTUAAUUJUVDUBVHZAYSUUQUUTW
        HZAKUGUHZUVDAUUOUVSUCUUOUVSULKWJUNKWKWLVDVHAYSUUQUUTWMZAYSUUQUUTWNZUVKW
        OWPUVEUVOUUDOQUGUVPUVEUVFUGUHZUVGUVPUHZVGZUVOUUDUVEUWDUVOVGZVGZBCUVGDEU
        VFFGHIJUUBUVMKLUUCNOPQRSTUAUVEUUJUWEUVQVHAUUOUVDUWEUCVSUVEYSUWEUWAVHUVE
        UUQUWEUVRVHUVEUUTUWEUVTVHUVEUWBUWCUVOWQUWFUWCUVKUGUVGVMUVEUWBUWCUVOWRUG
        UVKUVGWTULYRUOVOWSVFUVEUWDUVLUVNXAUVMWOUVEUWDUVLUVNXBXKXCXDXEUVEUUDXFXG
        XHXIXJXLXMXNAYTVGZUUHUUDFXOUUEUPVAZUQZJUGURZULUGUHZUWKUWJXPXPUWIUWKJULU
        GUUCULUJZUWIUUDFXOUQZUWKUWLUUDFUWHXOUWLUUEXOXQZUWHXOUJUWLULUUEUHUWNUWLU
        LULULUOVAZUUEULXRUHULUWOUHYNULXSXTUUCULULUOYAYBUUEULYCVDUUEUVCYDVDYEUWM
        UWKUUDFYFXPYGYHYIYJUWGEXOUJZUUHUWJWIAYTUWPAUUJYTUWPWIUBEUTYKVDVTUWPUUGU
        WIJUGUWPUUDFUUFUWHEXOUUEUPYOYEYLVDYMYPYQ @.
        @( [18-Aug-2014] @)
    @}

    @{
      vdwlemj.1 @e |- ( ph -> F : ( 1 ... ( ( # ` R ) + 1 ) ) --> R ) @.
      vdwlemj.2 @e |- ( ph -> -. 2 ( R O ( ( # ` R ) + 1 ) ) F ) @.
      @( Lemma for ~ vdw .  ` K = 2 ` base case of induction. @)
      vdwlemj @p |- -. ph @=
        ( vx vy vz vw c1 chash cfv caddc co cfz csdm wbr clt cn0 wcel cr hashcl
        cfn syl nn0re ltp1 3syl wceq cn nn0p1nn nnnn0 hashfz1 breqtrrd hashsdom
        wb fzfi sylancl mpbid cdom wn wf1 wf cv wral elfznn nnre anim12i adantl
        wi eleq1 bi2anan9 fveq2 eqeqan12d eqeq12 imbi12d ancom syl6bb eqcom cle
        wa biidd idd c2 ad2antrr csn cima cpw cin wne wrex simplrr syl2anc cmin
        c0 cpr wo cmul cc0 2nn a1i simplrl syl3anc wsbc ax-1cn cz 0z ax-mp ovex
        oveq2d eqeq2d sbcie cc nncn eqtrd syl5bb vex wfn ffn fniniseg mpbir2and
        cvv impancom crn ccnv ffvelrn nnsub vdwlemc 2cn 1p1e2 subaddrii addid2i
        simprr eqtr4i oveq2i fzpr eqtri rexeq elexi rexpr bitri oveq1 addid1 id
        mul02 syl6eq oveq1d mulid2 orbi12d bitrd elpr syl6bbr eqrdv cxp vdwlemb
        pncan3 mp2b fnovrn eqeltrrd wss fvex simprl eqidd jca prss sylib sylibr
        prex elpw inelcm sneq imaeq2d ineq2d neeq1d rcla4ev vdwlemd mpbird expr
        pweqd jctird eqlelt sylibrd com23 3ad2antr3 wlogle mpd ralrimivva dff13
        mtod ex sylanbrc f1dom domnsym pm2.65i ) AEUHEUIUJZUHUKULZUMULZUNUOZAUX
        LUXNUIUJZUPUOZUXOAUXLUXMUXPUPAUXLUQURZUXLUSURUXLUXMUPUOAEVAURZUXRUAEUTZ
        VBUXLVCUXLVDVEAUXMUQURZUXPUXMVFAUXMVGURZUYAAUXSUYBUAUXSUXRUYBUXTUXLVHVB
        ZVBUXMVIVBUXMVJVBVKAUXSUXNVAURUXQUXOVMUAUHUXMVNEUXNVLVOVPAUXNEVQUOZUXOV
        RAUXNEKVSZUYDAUXNEKVTZUDWAZKUJZUEWAZKUJZVFZUYGUYIVFZWGZUEUXNWBUDUXNWBUY
        EUBAUYMUDUEUXNUXNAUYGUXNURZUYIUXNURZWRZWRZUYGUSURZUYIUSURZWRZUYMUYPUYTA
        UYNUYRUYOUYSUYNUYGVGURZUYRUYGUXMWCZUYGWDVBZUYOUYIVGURZUYSUYIUXMWCZUYIWD
        VBZWEWFAUYTUYPUYMAUFWAZUXNURZUGWAZUXNURZWRZVUGKUJZVUIKUJZVFZVUGVUIVFZWG
        ZWGUYPUYMWGZVUQUDUEUFUGVUGUYGVFZVUIUYIVFZWRZVUKUYPVUPUYMVURVUHUYNVUSVUJ
        UYOVUGUYGUXNWHVUIUYIUXNWHWIVUTVUNUYKVUOUYLVURVUSVULUYHVUMUYJVUGUYGKWJVU
        IUYIKWJWKVUGUYGVUIUYIWLWMWMVUGUYIVFZVUIUYGVFZWRZVUKUYPVUPUYMVVCVUKUYOUY
        NWRUYPVVAVUHUYOVVBVUJUYNVUGUYIUXNWHVUIUYGUXNWHWIUYOUYNWNWOVVCVUNUYKVUOU
        YLVVCVUNUYJUYHVFUYKVVAVVBVULUYJVUMUYHVUGUYIKWJVUIUYGKWJWKUYJUYHWPWOVVCV
        UOUYIUYGVFUYLVUGUYIVUIUYGWLUYIUYGWPWOWMWMAUYTWRVUQWSAUYRUYGUYIWQUOZVUQU
        YSAUYPVVDUYMUYQUYKVVDUYLUYQUYKVVDUYLWGUYQUYKWRZVVDVVDUYGUYIUPUOZVRZWRZU
        YLVVEVVDVVDVVGVVEVVDWTVVEVVFXAKEUXMLULUOZAVVIVRUYPUYKUCXBUYQUYKVVFVVIUY
        QUYKVVFWRZWRZVVIXACUJZUUAZKUUBZOWAZXCZXDZXEZXFZXLXGZOEXHZVVKUYJEURZVVMV
        VNUYJXCZXDZXEZXFZXLXGZVWAVVKUYFUYOVWBAUYFUYPVVJUBXBZAUYNUYOVVJXIZUXNEUY
        IKUUCXJVVKUYGUYIXMZVVMURVWJVWEURZVWGVVKUYGUYIUYGXKULZVVLULZVWJVVMVVKUFV
        WMVWJVVKVUGVWMURZVURVVAXNZVUGVWJURVVKVWNVUGUYGIWAZVWLXOULZUKULZVFZIXPXA
        UHXKULZUMULZXHZVWOVVKXAVGURZVUAVWLVGURZVWNVXBVMVXCVVKXQXRZVVKUYNVUAAUYN
        UYOVVJXSZVUBVBZVVKVVFVXDUYQUYKVVFUUJVVKVUAVUDVVFVXDVMVXGVVKUYOVUDVWIVUE
        VBZUYGUYIUUDXJVPZCVWLUYGHIXAVUGNPQUUEXTVXBVWSIXPYAZVWSIXPUHUKULZYAZXNZV
        VKVWOVXBVWSIXPVXKXMZXHZVXMVXAVXNVFVXBVXOVMVXAXPVXKUMULZVXNVWTVXKXPUMVWT
        UHVXKXAUHUHUUFYBYBUUGUUHUHYBUUIZUUKUULXPYCURVXPVXNVFYDXPUUMYEUUNVWSIVXA
        VXNUUOYEVWSIXPVXKXPYCYDUUPZXPUHUKYFZUUQUURVVKVXJVURVXLVVAVXJVUGUYGXPVWL
        XOULZUKULZVFZVVKVURVWSVYBIXPVXRVWPXPVFZVWRVYAVUGVYCVWQVXTUYGUKVWPXPVWLX
        OUUSYGYHYIVVKVYAUYGVUGVVKVYAUYGXPUKULZUYGVVKVXTXPUYGUKVVKVWLYJURZVXTXPV
        FVVKVXDVYEVXIVWLYKVBZVWLUVBVBYGVVKUYGYJURZVYDUYGVFVVKVUAVYGVXGUYGYKVBZU
        YGUUTVBYLYHYMVXLVUGUYGUHVWLXOULZUKULZVFZVVKVVAVWSVYKIVXKVXSVWPVXKVFZVWR
        VYJVUGVYLVWQVYIUYGUKVYLVWPUHVWLXOVYLVWPVXKUHVYLUVAVXQUVCUVDYGYHYIVVKVYJ
        UYIVUGVVKVYJUYGVWLUKULZUYIVVKVYIVWLUYGUKVVKVYEVYIVWLVFVYFVWLUVEVBYGVVKV
        YGUYIYJURZVYMUYIVFVYHVVKVUDVYNVXHUYIYKVBUYGUYIUVMXJYLYHYMUVFYMUVGVUGUYG
        UYIUFYNUVHUVIUVJVVKVVLVGVGUVKZYOZVUAVXDVWMVVMURVYPVVKVXCVYOVGXEZVVLVTVY
        PXQCHIXANPQUVLVYOVYQVVLYPUVNXRVXGVXIVGVGUYGVWLVVLUVOXTUVPVVKVWJVWDUVQZV
        WKVVKUYGVWDURZUYIVWDURZWRVYRVVKVYSVYTVVKVYSUYNUYKVVKKUXNYOZUYJYSURZVYSU
        YNUYKWRVMVVKUYFWUAVWHUXNEKYPVBZUYIKUVRZUXNUYJUYGKYSYQVOVXFUYQUYKVVFUVSY
        RVVKVYTUYOUYJUYJVFZVVKWUAWUBVYTUYOWUEWRVMWUCWUDUXNUYJUYIKYSYQVOVWIVVKUY
        JUVTYRUWAUYGUYIVWDUDYNUEYNUWBUWCVWJVWDUYGUYIUWEUWFUWDVWJVVMVWEUWGXJVVTV
        WGOUYJEVVOUYJVFZVVSVWFXLWUFVVRVWEVVMWUFVVQVWDWUFVVPVWCVVNVVOUYJUWHUWIUW
        PUWJUWKUWLXJVVKCEFHIJKXAUXMLMNOPQRAUXSUYPVVJUAXBZVVKUXSUYBWUGUYCVBVXEVW
        HUWMUWNUWOUXFUWQVVEUYRUYSUYLVVHVMVVEUYNUYRAUYNUYOUYKXSVUCVBVVEUYOUYSAUY
        NUYOUYKXIVUFVBUYGUYIUWRXJUWSUXGUWTYTUXAUXBYTUXCUXDUDUEUXNEKUXEUXHUXNEKU
        HUXMUMYFUXIVBUXNEUXJVBUXK @.
        @( [18-Aug-2014] @)
    @}

    vdw.k @e |- ( ph -> K e. NN ) @.
    @( Lemma for ~ vdw .  Main induction on ` K ` ; ` K = 1 ` base case. @)
    vdwlemg @p |- ( ph -> E. n e. NN
      A. f e. ( R ^m ( 1 ... n ) ) K ( R O n ) f ) @=
      ( vx vs c1 wceq c2 cuz cfv wcel wo cv co wbr cfz cmap wral elnn1uz2 sylib
      cn wrex wi 1nn wf cfn cvv wb ovex elmapg sylancl biimpa crn ccnv csn cima
      wa cpw cin c0 wne simpr cz elfz3 ax-mp ffvelrn cmul caddc cc0 cmin ax-1cn
      1z subidi oveq2i fzsn eqtri rexeq elexi oveq1 mul02i syl6eq oveq2d eqeq2d
      addid1i rexsn bitri vdwlemc mp3an elsn 3bitr4i eqriv cxp wfn vdwlemb mp2b
      0z ffn fnovrn eqeltrri wss adantl fvex fniniseg a1i eqidd mpbir2and snssd
      sylancr rcla4ev syl2anc ralrimiva oveq2 breqd raleqbidv breq1 ralbidv syl
      rexbidv wn simpll simplr snex elpw sylibr inelcm sneq pweqd ineq2d neeq1d
      imaeq2d adantr vdwlemd mpbird syldan syl5ibr chash cn0 hashcl nn0p1nn vex
      elmap vdwlemj iman mpbir rgen cbvralv vdwlemf ex syl5bir ralrimdva syl5bi
      uzind4 rcla4v syl5com jaoi mpcom ) KUEUFZKUGUHUIZUJZUKZAKFULZEJULZLUMZUNZ
      FEUEUWAUOUMZUPUMZUQZJUTVAZAKUTUJUVSUBKURUSUVPAUWGVBUVRAUWGUVPUEUVTUWBUNZF
      UWEUQZJUTVAZAUEUTUJZUEUVTEUELUMZUNZFEUEUEUOUMZUPUMZUQZUWJVCAUWMFUWOAUVTUW
      OUJZUWNEUVTVDZUWMAUWQUWRAEVEUJZUWNVFUJUWQUWRVGUAUEUEUOVHEUWNUVTVEVFVIVJVK
      AUWRVPZUWMUECUIZVLZUVTVMZOULZVNZVOZVQZVRZVSVTZOEVAZUWTUEUVTUIZEUJZUXBUXCU
      XKVNZVOZVQZVRZVSVTZUXJUWTUWRUEUWNUJZUXLAUWRWAZUEWBUJUXRWKUEWCWDZUWNEUEUVT
      WEVJUWTUEVNZUXBUJUYAUXOUJZUXQUEUEUXAUMZUYAUXBUCUYCUYAUCULZUEIULZUEWFUMZWG
      UMZUFZIWHUEUEWIUMZUOUMZVAZUYDUEUFZUYDUYCUJZUYDUYAUJUYKUYHIWHVNZVAZUYLUYJU
      YNUFUYKUYOVGUYJWHWHUOUMZUYNUYIWHWHUOUEWJWLWMWHWBUJUYPUYNUFXOWHWNWDWOUYHIU
      YJUYNWPWDUYHUYLIWHWHWBXOWQUYEWHUFZUYGUEUYDUYQUYGUEWHWGUMUEUYQUYFWHUEWGUYQ
      UYFWHUEWFUMWHUYEWHUEWFWRUEWJWSWTXAUEWJXCWTXBXDXEUWKUWKUWKUYMUYKVGVCVCVCCU
      EUEHIUEUYDNPQXFXGUCUEXHXIXJUXAUTUTXKZXLZUWKUWKUYCUXBUJUWKUYRUTVQZUXAVDUYS
      VCCHIUENPQXMUYRUYTUXAXPXNVCVCUTUTUEUEUXAXQXGXRUWTUYAUXNXSUYBUWTUEUXNUWTUE
      UXNUJZUXRUXKUXKUFZUWTUVTUWNXLZUXKVFUJVUAUXRVUBVPVGUWRVUCAUWNEUVTXPXTUEUVT
      YAUWNUXKUEUVTVFYBVJUXRUWTUXTYCUWTUXKYDYEYFUYAUXNUEUUAUUBUUCUYAUXBUXOUUDYG
      UXIUXQOUXKEUXDUXKUFZUXHUXPVSVUDUXGUXOUXBVUDUXFUXNVUDUXEUXMUXCUXDUXKUUEUUI
      UUFUUGUUHYHYIUWTCEFHIJUVTUEUELMNOPQRAUWSUWRUAUUJUWKUWTVCYCZVUEUXSUUKUULUU
      MYJUWIUWPJUEUTUWAUEUFZUWHUWMFUWEUWOVUFUWDUWNEUPUWAUEUEUOYKXAVUFUWBUWLUEUV
      TUWAUEELYKYLYMYHYGUVPUWFUWIJUTUVPUWCUWHFUWEKUEUVTUWBYNYOYQUUNUVRKUVTMULZU
      WALUMZUNZFVUGUWDUPUMZUQZJUTVAZMVEUQZAUWGUYDUVTVUHUNZFVUJUQZJUTVAZMVEUQUGU
      VTVUHUNZFVUJUQZJUTVAZMVEUQZHULZUVTVUHUNZFVUJUQZJUTVAZMVEUQZVVAUEWGUMZUVTV
      UHUNZFVUJUQZJUTVAZMVEUQZVUMUCHUGKUYDUGUFZVUPVUSMVEVVKVUOVURJUTVVKVUNVUQFV
      UJUYDUGUVTVUHYNYOYQYOUYDVVAUFZVUPVVDMVEVVLVUOVVCJUTVVLVUNVVBFVUJUYDVVAUVT
      VUHYNYOYQYOUYDVVFUFZVUPVVIMVEVVMVUOVVHJUTVVMVUNVVGFVUJUYDVVFUVTVUHYNYOYQY
      OUYDKUFZVUPVULMVEVVNVUOVUKJUTVVNVUNVUIFVUJUYDKUVTVUHYNYOYQYOVUTUGWBUJVUSM
      VEVUGVEUJZVUGUUOUIZUEWGUMZUTUJZUGUVTVUGVVQLUMZUNZFVUGUEVVQUOUMZUPUMZUQZVU
      SVVOVVPUUPUJVVRVUGUUQVVPUURYPVVOVVTFVWBVVOUVTVWBUJZVPZVVTVBVWEVVTYRZVPZYR
      VWGBCDVUGFGHIJUVTLMNOPQRSTVVOVWDVWFYSVWGVWDVWAVUGUVTVDVVOVWDVWFYTVUGVWAUV
      TMUUSUEVVQUOVHUUTUSVWEVWFWAUVAVWEVVTUVBUVCYJVURVWCJVVQUTUWAVVQUFZVUQVVTFV
      UJVWBVWHUWDVWAVUGUPUWAVVQUEUOYKXAVWHVUHVVSUGUVTUWAVVQVUGLYKYLYMYHYIUVDYCV
      VEVVAUVTUDULZUWALUMZUNZFVWIUWDUPUMZUQZJUTVAZUDVEUQZVVAUVQUJZVVJVVDVWNMUDV
      EVUGVWIUFZVVCVWMJUTVWQVVBVWKFVUJVWLVUGVWIUWDUPWRVWQVUHVWJVVAUVTVUGVWIUWAL
      WRYLYMYQUVEZVWPVWOVVIMVEVWOVVEVWPVVOVPZVVIVWRVWSVVEVVIVWSVVEVPZBCDVUGFGHI
      JVVALUDMNOPQRSTVWPVVOVVEYTVWPVVOVVEYSVWTVVEVWOVWSVVEWAVWRUSUVFUVGUVHUVIUV
      JUVKAUWSVUMUWGVBUAVULUWGMEVEVUGEUFZVUKUWFJUTVXAVUIUWCFVUJUWEVUGEUWDUPWRVX
      AVUHUWBKUVTVUGEUWALWRYLYMYQUVLYPUVMUVNUVO @.
      @( [18-Aug-2014] @)

    @( Lemma for ~ vdw .  Expand out the predicate for the final theorem. @)
    vdwleml @p |- ( ph -> E. n e. NN
      A. f e. ( R ^m ( 1 ... n ) ) E. c e. R E. a e. NN E. d e. NN
      A. m e. ( 0 ... ( K - 1 ) ) ( a + ( m x. d ) ) e. ( `' f " { c } ) ) @=
      ( vx cv co wbr c1 cfz cmap wral cn wrex cmul caddc ccnv csn cima wcel cc0
      cmin vdwlemg wa cfv crn cpw cin c0 wne cfn ad2antrr simplr simpr cvv ovex
      wf wb elmapg sylancl mpbid vdwlemd wex n0 wss elin elpw anbi2i bitri wceq
      vex wi cxp wfn adantr vdwlemb syl ffn ovelrn 3syl sseq1 biimpac wal dfss2
      simprl simprr vdwlemc syl3anc imbi1d r19.23v syl6bbr albidv ralcom4 eleq1
      ceqsalv ralbii bitr3i syl6bb syl5bb biimpd impancom sylan2 reximdva com23
      anassrs ex sylbid imp3a syl5bi exlimdv ralimdva mpd ) AKFUDZEJUDZLUEUFZFE
      UGYLUHUEZUIUEZUJZJUKULNUDZIUDPUDZUMUEZUNUEZYKUOOUDZUPUQZURZIUSKUGUTUEUHUE
      ZUJZPUKULZNUKULZOEULZFYOUJZJUKULABCDEFGHIJKLMNOPQRSTUAUBVAAYPUUIJUKAYLUKU
      RZVBZYMUUHFYOUUKYKYOURZVBZYMKCVCZVDZUUBVEZVFZVGVHZOEULUUHUUMCEFHIJYKKYLLM
      NOPQRAEVIURZUUJUULUAVJZAUUJUULVKAKUKURZUUJUULUBVJZUUMUULYNEYKVOZUUKUULVLU
      UMUUSYNVMURUULUVCVPUUTUGYLUHVNEYNYKVIVMVQVRVSVTUUMUURUUGOEUURUCUDZUUQURZU
      CWAUUMUUAEURZVBZUUGUCUUQWBUVGUVEUUGUCUVEUVDUUOURZUVDUUBWCZVBZUVGUUGUVEUVH
      UVDUUPURZVBUVJUVDUUOUUPWDUVKUVIUVHUVDUUBUCWIWEWFWGUVGUVHUVIUUGUVGUVHUVDYQ
      YRUUNUEZWHZPUKULZNUKULZUVIUUGWJUVGUKUKWKZUKVEZUUNVOZUUNUVPWLUVHUVOVPUVGUV
      AUVRUUMUVAUVFUVBWMZCHIKNPQWNWOUVPUVQUUNWPNPUKUKUVDUUNWQWRUVGUVIUVOUUGUVGU
      VIUVOUUGWJUVGUVIVBZUVNUUFNUKUVTYQUKURZVBUVMUUEPUKUVTUWAYRUKURZUVMUUEWJUVT
      UVMUWAUWBVBZUUEUVGUVIUVMUWCUUEWJZUVIUVMVBUVGUVLUUBWCZUWDUVMUVIUWEUVDUVLUU
      BWSWTUVGUWCUWEUUEUVGUWCVBZUWEUUEUWEUVDUVLURZUVDUUBURZWJZUCXAZUWFUUEUCUVLU
      UBXBUWFUWJUVDYTWHZUWHWJZIUUDUJZUCXAZUUEUWFUWIUWMUCUWFUWIUWKIUUDULZUWHWJUW
      MUWFUWGUWOUWHUWFUVAUWAUWBUWGUWOVPUVGUVAUWCUVSWMUVGUWAUWBXCUVGUWAUWBXDCYRY
      QHIKUVDNPQXEXFXGUWKUWHIUUDXHXIXJUWNUWLUCXAZIUUDUJUUEUWLIUCUUDXKUWPUUCIUUD
      UWHUUCUCYTYQYSUNVNUVDYTUUBXLXMXNXOXPXQXRXSXTYCXSYCYAYAYDYBYEYFYGYHYGYAYEY
      IYAYJ @.
      @( [18-Aug-2014] @)
  @}

  @{
    @( Van der Waerden's theorem. For any finite coloring ` R ` and integer
       ` K ` , every coloring function from ` 1 ... N ` to ` R ` contains a
       monochromatic arithmetic progression (which written out in full means
       that there is a color ` c ` and base, increment values ` a , d ` such
       that all the numbers ` a , a + d , ... , a + ( k - 1 ) d ` lie in the
       preimage of ` { c } ` , i.e. they are all in ` 1 ... N ` and ` f `
       evaluated at each one yields ` c ` ). @)
    vdw @p |- ( ( R e. Fin /\ K e. NN ) -> E. n e. NN
      A. f e. ( R ^m ( 1 ... n ) ) E. c e. R E. a e. NN E. d e. NN
      A. m e. ( 0 ... ( K - 1 ) ) ( a + ( m x. d ) ) e. ( `' f " { c } ) ) @=
      ( vi vk vr cfn wcel cn wa cv cfv co c1 cmpt caddc cc0 cmin cfz cmul cmpt2
      crn ccnv csn cima wss wral chash wceq cmap wrex copab cpw cin c0 wne eqid
      biid simpl simpr vdwleml ) ALMZENMZOFPZIPHPZQZUARZVKJPZJNFHNNCUBVMSUCRUDR
      VICPZVJUERUARTUGUFTZQZRBPZUHZVLVQQZUIUJUKISVNUDRZULIVTVSTUGUMQVNUNOZVOKDL
      NCNVMNMVQKPZSDPUDRUORMOZWAHNVTUORUPFNUPOJBUQTUFZABIJCDEKDLNWCVPUGVRGPUIUJ
      URUSUTVAGWBUPOJBUQUFZKFGHVOVBWEVBWAVCWDVBVGVHVDVGVHVEVF @.
      @( [18-Aug-2014] @)
  @}
  $)

