$(
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
                           Pocklington's theorem
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
$)


  ${
    $d x z P $.
    $( One need only check prime divisors of ` P ` up to ` sqr P ` in order to
       ensure primality.  (Contributed by Mario Carneiro, 18-Feb-2014.) $)
    isprm5 $p |- ( P e. Prime <-> ( P e. ( ZZ>= ` 2 ) /\
                    A. z e. Prime ( ( z ^ 2 ) <_ P -> -. z || P ) ) ) $=
      ( cprime wcel c2 wbr wceq wi wa co cle wn cmul clt c1 cr cc0 syl syl11anc
      syl111anc vx cuz cfv cdivides wral cexp isprm4 prmuz2 a1i eluz2b2 simprbi
      cv cn wb eluzelre simplbi nngt0 ltmulgt11 ax-mulrcl opreq12 anidms breq1d
      mpbid ltnle notbid syl5ibrcom imim2d con2 imim12d ralimdv2 annim ad2antlr
      syl6 wrex wo ad2antrr letric breq1 anbi12d rcla4ev ancom2s expr ad2ant2lr
      cdiv crp simplr nnmulcl nnrp rpdivcl syl2an elrp sylib lemul1 recnd nnne0
      cc wne divmuldiv syl22anc nncn divass eqtrd divcan2 eqcomd breq12d bitr4d
      jca biimpd eluzelz simprl divides2 dvds0lem syl31anc jctird mulid2 dvdsle
      cz ltlen imp syl21anc simprr sylibr necomd mpbir2and eqbrtrd 1re zre nnre
      df-ne ltmuldiv mpd ex rexlimdva ad2antrl remulcl nnnn0 nn0ge0 3syl rexnal
      cn0 eluz2b1 sylanbrc jaod syl5bir exprmfct prmz simpllr ad3antrrr simplrl
      jctild le2msq letrd simplrr dvdstr mp2and df-an syld 3imtr3g con4d impbid
      reximdva prmnn sqval imbi1d ralbiia syl6bbr pm5.32i bitri ) BCDBEUBUCZDZA
      ULZBUDFZUVKBGZHZAUVIUEZIUVJUVKEUFJZBKFZUVLLZHZACUEZIABUGUVJUVOUVTUVJUVOUV
      KUVKMJZBKFZUVRHZACUEZUVTUVJUVOUWDUVJUVNUWCAUVICUVJUVKCDZUVKUVIDZUVNUWCUWE
      UWFHUVJUVKUHZUIUVJUVNUVLUWBLZHUWCUVJUVMUWHUVLUVJUWHUVMBBMJZBKFZLZUVJBUWIN
      FZUWKUVJOBNFZUWLUVJBUMDZUWMBUJZUKUVJBPDZUWPQBNFZUWMUWLUNEBUOZUWRUVJUWNUWQ
      UVJUWNUWMUWOUPZBUQRBBURTVCUVJUWPUWIPDZUWLUWKUNUWRUVJUWPUWPUWTUWRUWRBBUSSB
      UWIVDSVCUVMUWBUWJUVMUWAUWIBKUVMUWAUWIGUVKBUVKBMUTVAVBVEVFVGUVLUWBVHVMVIVJ
      UVJUVOUWDUVJUVNLZAUVIVNZUWCLZACVNZUVOLUWDLUVJUXBUAULZUXEMJZBKFZUXEBUDFZIZ
      UAUVIVNZUXDUVJUXAUXJAUVIUXAUVLUVMLZIZUVJUWFIZUXJUVLUVMVKUXMUXLUXJUXMUXLIZ
      UWBBUWAKFZVOZUXJUXNUWAPDZUWPUXPUXNUVKPDZUXRUXQUWFUXRUVJUXLEUVKUOVLZUXSUVK
      UVKUSSZUVJUWPUWFUXLUWRVPZUWABVQSUXNUWBUXJUXOUWFUVLUWBUXJHUVJUXKUWFUVLUWBU
      XJUWFUWBUVLUXJUXIUWBUVLIZUAUVKUVIUXEUVKGZUXGUWBUXHUVLUYCUXFUWABKUYCUXFUWA
      GUXEUVKUXEUVKMUTVAVBUXEUVKBUDVRVSVTWAWBWCUXNUXOBUVKWDJZUVIDZUYDUYDMJZBKFZ
      UYDBUDFZIZIUXJUXNUXOUYIUYEUXNUXOUYGUYHUXNUXOUYGUXNUXOBBUWAWDJZMJZUWAUYJMJ
      ZKFZUYGUXNUWPUXQUYJPDQUYJNFIZUXOUYMUNUYAUXTUXNUYJWEDZUYNUXNUWNUWAUMDZUYOU
      VJUWNUWFUXLUWSVPZUXNUVKUMDZUYRUYPUXNUWFUYRUVJUWFUXLWFUWFUYROUVKNFUVKUJUPZ
      RZUYTUVKUVKWGSZUWNBWEDUWAWEDUYOUYPBWHUWAWHBUWAWIWJSUYJWKWLBUWAUYJWMTUXNUY
      FUYKBUYLKUXNUYFUWIUWAWDJZUYKUXNBWPDZVUCUVKWPDZUVKQWQZIZVUFUYFVUBGUXNBUYAW
      NZVUGUXNVUDVUEUXNUVKUXSWNZUXNUYRVUEUYTUVKWORZXGZVUJBBUVKUVKWRWSUXNVUCVUCU
      WAWPDZUWAQWQZIVUBUYKGVUGVUGUXNVUKVULUXNUYPVUKVUAUWAWTRZUXNUYPVULVUAUWAWOR
      ZXGBBUWAXATXBUXNUYLBUXNVUCVUKVULUYLBGVUGVUMVUNBUWAXCTXDXEXFXHUXNUVKXQDZUY
      DXQDZBXQDZUVKUYDMJBGZUYHUWFVUOUVJUXLEUVKXIVLZUXNUVLVUPUXMUVLUXKXJZUXNVUOV
      UEVUQUVLVUPUNVUSVUIUVJVUQUWFUXLEBXIZVPZUVKBXKTVCZVVBUXNVUCVUDVUEVURVUGVUH
      VUIBUVKXCTUVKUYDBXLXMXNUXNVUPOUYDNFZUYEVVCUXNOUVKMJZBNFZVVDUXNVVEUVKBNUXN
      VUDVVEUVKGVUHUVKXORUXNUVKBNFZUVKBKFZBUVKWQZUXNUXRUWPVVGVVHVVIIUNUXSUYAUVK
      BXRSUXNVUOUWNUVLVVHVUSUYQVUTVUOUWNIUVLVVHUVKBXPXSXTUXNUVKBUXNUXKUVKBWQUXM
      UVLUXKYAUVKBYIYBYCYDYEUXNOPDZUWPUXRQUVKNFZIZVVFVVDUNVVJUXNYFUIUXNVUQUWPVV
      BBYGZRUXNUYRVVLUYTUYRUXRVVKUVKYHUVKUQXGROBUVKYJTVCUYDUUAUUBUUJUXIUYIUAUYD
      UVIUXEUYDGZUXGUYGUXHUYHVVNUXFUYFBKVVNUXFUYFGUXEUYDUXEUYDMUTVAVBUXEUYDBUDV
      RVSVTVMUUCYKYLUUDYMUVJUXIUXDUAUVIUVJUXEUVIDZIZUXIUXDVVPUXIIZUVKUXEUDFZACV
      NZUXDVVOVVSUVJUXIUXEAUUEVLVVQVVRUXCACVVQUWEVVRUXCVVQUWEVVRIZIZUYBUXCVWAUW
      BUVLVWAUWAUXFBVWAUXRUXRUXQVWAVUOUXRUWEVUOVVQVVRUVKUUFYNZUVKYGRZVWCUVKUVKY
      OSVWAUXEPDZVWDUXFPDVWAUXEXQDZVWDVWAVVOVWEUVJVVOUXIVVTUUGZEUXEXIRZUXEYGRZV
      WHUXEUXEYOSVWAVUQUWPUVJVUQVVOUXIVVTVVAUUHZVVMRVWAUVKUXEKFZUWAUXFKFZVWAVUO
      UXEUMDZVVRVWJVWBVWAVVOVWLVWFVVOVWLOUXENFUXEUJUPRZVVQUWEVVRYAZVUOVWLIVVRVW
      JUVKUXEXPXSXTVWAUXRQUVKKFZVWDQUXEKFZVWJVWKUNVWCUWEVWOVVQVVRUWEUWFVWOUWGUW
      FUYRUVKYTDVWOUYSUVKYPUVKYQYRRYNVWHVWAVWLVWPVWMVWLUXEYTDVWPUXEYPUXEYQRRUVK
      UXEUUKWSVCVVPUXGUXHVVTUUIUULVWAVVRUXHUVLVWNVVPUXGUXHVVTUUMVWAVUOVWEVUQVVR
      UXHIUVLHVWBVWGVWIUVKUXEBUUNTUUOXGUWBUVLUUPWLWBUVAYKYLYMUUQUVNAUVIYSUWCACY
      SUURUUSUUTUVSUWCACUWEUVQUWBUVRUWEUVPUWABKUWEUYRVUDUVPUWAGUVKUVBUVKWTUVKUV
      CYRVBUVDUVEUVFUVGUVH $.
      $( [18-Feb-2014] $)
  $}

  ${
    ndvdsi.1 $e |- A e. NN $.
    ndvdsi.2 $e |- Q e. NN0 $.
    ndvdsi.3 $e |- R e. NN $.
    ndvdsi.4 $e |- B = ( ( A x. Q ) + R ) $.
    ndvdsi.5 $e |- R < A $.
    $( A quick test for non-divisibility.  (Contributed by Mario Carneiro,
       18-Feb-2014.) $)
    ndvdsi $p |- -. A || B $=
      ( cdivides wbr cmul co caddc wn cz wcel cn ax-mp mp2an nnz cn0 nn0z wa wi
      dvdsmul1 clt zmulcl pm3.2i ndvdsadd mp3an breq2i mtbir ) ABJKAACLMZDNMZJK
      ZAUNJKZUPOZAPQZCPQZUQARQZUSEAUASZCUBQUTFCUCSZACUFTUNPQZVADRQZDAUGKZUDUQUR
      UEUSUTVDVBVCACUHTEVEVFGIUIADUNUJUKSBUOAJHULUM $.
      $( [18-Feb-2014] $)
  $}

  ${
    $d k n x D $.  $d k K $.  $d k x N $.  $d k n x P $.
    $( A relation involving divisibility by a prime power.  (Contributed by
       Mario Carneiro, 2-Mar-2014.) $)
    prmpwdvds $p |- ( ( ( K e. ZZ /\ D e. ZZ ) /\ ( P e. Prime /\ N e. NN ) /\
         ( D || ( K x. ( P ^ N ) ) /\ -. D || ( K x. ( P ^ ( N - 1 ) ) ) ) ) ->
                   ( P ^ N ) || D ) $=
      ( vk cz wcel wa cexp co cmul cdivides wbr c1 wceq opreq2d breq2d syl11anc
      wi syl vx vn cprime cn cmin wn cv wral simpll caddc opreq2 opreq1 anbi12d
      notbid breq1d imbi12d ralbidv imbi2d breq1 breq2 cgcd wb simplrl coprm cc
      zcn ad2antll prmz ad2antrl mulcom simpl gcdcom eqeq1d coprmdvds syl111anc
      simprr sylbid expdimp con1d expimpd ex vtoclga anassrs exp1 3syl ad2antlr
      imp cc0 ax-1cn subidi opreq2i simplr syl5eq adantl mulid1 eqtrd ralrimiva
      exp0 3imtr4d imbi1d cbvralv zmulcl rcla4v wrex cn0 nnnn0 ad2antrr divides
      zexpcl adantll prmnn nncn expp1 nnexpcl mulass eqtr4d wne nnne0 dvdsmulcr
      nnz syl112anc bitrd an32s syl5ibcom rexlimdva adantlr com23 nnm1nn0 pncan
      a2d expm1t sylancl anbi2d syld ralrimdva syl5bi anasss nnind com12 impr
      sylc 3impia ) CFGZAFGZHZBUCGZDUDGZHZACBDIJZKJZLMZACBDNUEJZIJZKJZLMZUFZHZU
      UIALMZUUEUUHHUUCAEUGZUUIKJZLMZAUUSUUMKJZLMZUFZHZUURSZEFUHZUUQUURSZUUCUUDU
      UHUIUUDUUHUVGUUCUUDUUFUUGUVGUUGUUDUUFHZUVGUVIAUUSBUAUGZIJZKJZLMZAUUSBUVJN
      UEJZIJZKJZLMZUFZHZUVKALMZSZEFUHZSUVIAUUSBNIJZKJZLMZAUUSBNNUEJZIJZKJZLMZUF
      ZHZUWCALMZSZEFUHZSUVIAUUSBUBUGZIJZKJZLMZAUUSBUWONUEJZIJZKJZLMZUFZHZUWPALM
      ZSZEFUHZSUVIAUUSBUWONUJJZIJZKJZLMZAUUSBUXHNUEJZIJZKJZLMZUFZHZUXIALMZSZEFU
      HZSUVIUVGSUAUBDUVJNOZUWBUWNUVIUYAUWAUWMEFUYAUVSUWKUVTUWLUYAUVMUWEUVRUWJUY
      AUVLUWDALUYAUVKUWCUUSKUVJNBIUKZPQUYAUVQUWIUYAUVPUWHALUYAUVOUWGUUSKUYAUVNU
      WFBIUVJNNUEULPPQUNUMUYAUVKUWCALUYBUOUPUQURUVJUWOOZUWBUXGUVIUYCUWAUXFEFUYC
      UVSUXDUVTUXEUYCUVMUWRUVRUXCUYCUVLUWQALUYCUVKUWPUUSKUVJUWOBIUKZPQUYCUVQUXB
      UYCUVPUXAALUYCUVOUWTUUSKUYCUVNUWSBIUVJUWONUEULPPQUNUMUYCUVKUWPALUYDUOUPUQ
      URUVJUXHOZUWBUXTUVIUYEUWAUXSEFUYEUVSUXQUVTUXRUYEUVMUXKUVRUXPUYEUVLUXJALUY
      EUVKUXIUUSKUVJUXHBIUKZPQUYEUVQUXOUYEUVPUXNALUYEUVOUXMUUSKUYEUVNUXLBIUVJUX
      HNUEULPPQUNUMUYEUVKUXIALUYFUOUPUQURUVJDOZUWBUVGUVIUYGUWAUVFEFUYGUVSUVEUVT
      UURUYGUVMUVAUVRUVDUYGUVLUUTALUYGUVKUUIUUSKUVJDBIUKZPQUYGUVQUVCUYGUVPUVBAL
      UYGUVOUUMUUSKUYGUVNUULBIUVJDNUEULPPQUNUMUYGUVKUUIALUYHUOUPUQURUVIUWMEFUVI
      UUSFGZHZAUUSBKJZLMZAUUSLMZUFZHZBALMZUWKUWLUUDUUFUYIUYOUYPSZUUDUUFUYIHZUYQ
      UYRUVJUYKLMZUVJUUSLMZUFZHZBUVJLMZSZSUYRUYQSUAAFUVJAOZVUDUYQUYRVUEVUBUYOVU
      CUYPVUEUYSUYLVUAUYNUVJAUYKLUSVUEUYTUYMUVJAUUSLUSUNUMUVJABLUTUPURUVJFGZUYR
      VUDVUFUYRHZUYSVUAVUCVUGUYSHZVUCUYTVUHVUCUFZBUVJVAJZNOZUYTVUHUUFVUFVUIVUKV
      BVUFUUFUYIUYSVCVUFUYRUYSUIBUVJVDRVUGUYSVUKUYTVUGUYSVUKHUVJBUUSKJZLMZUVJBV
      AJZNOZHZUYTVUGUYSVUMVUKVUOVUGUYKVULUVJLVUGUUSVEGZBVEGZUYKVULOUYIVUQVUFUUF
      UUSVFZVGVUGBFGZVURUUFVUTVUFUYIBVHZVIZBVFZTUUSBVJRQVUGVUJVUNNVUGVUTVUFVUJV
      UNOVVBVUFUYRVKZBUVJVLRVMUMVUGVUFVUTUYIVUPUYTSVVDVVBVUFUUFUYIVPUVJBUUSVNVO
      VQVRVQVSVTZWAWBWGWCUYJUWEUYLUWJUYNUYJUWDUYKALUYJUWCBUUSKUUFUWCBOZUUDUYIUU
      FVUTVURVVFVVAVVCBWDZWEWFPQUYJUWIUYMUYJUWHUUSALUYJUWHUUSNKJZUUSUYJUWGNUUSK
      UYJUWGBWHIJZNUWFWHBINWIWJWKUYJVURVVINOUYJUUFVUTVURUUDUUFUYIWLVVAVVCWEZBWR
      TWMPUYJVUQVVHUUSOUYIVUQUVIVUSWNUUSWOTWPQUNUMUYJUWCBALUYJVURVVFVVJVVGTUOWS
      WQUWOUDGZUVIUXGUXTVVKUVIUXGUXTSZVVKUUDUUFVVLUXGAUVJUWPKJZLMZAUVJUWTKJZLMZ
      UFZHZUXESZUAFUHZVVKUUDHZUUFHZUXTUXFVVSEUAFUUSUVJOZUXDVVRUXEVWCUWRVVNUXCVV
      QVWCUWQVVMALUUSUVJUWPKULQVWCUXBVVPVWCUXAVVOALUUSUVJUWTKULQUNUMWTXAVWBVVTU
      XSEFVWAUUFUYIVVTUXSSVWAUYRHZVVTAUYKUWPKJZLMZAUYKUWTKJZLMZUFZHZUXESZUXSVWD
      UYKFGZVVTVWKSVWDUYIVUTVWLVWAUUFUYIVPZUUFVUTVWAUYIVVAVIZUUSBXBZRVVSVWKUAUY
      KFUVJUYKOZVVRVWJUXEVWPVVNVWFVVQVWIVWPVVMVWEALUVJUYKUWPKULQVWPVVPVWHVWPVVO
      VWGALUVJUYKUWTKULQUNUMWTXCTVWDUXKUWRUFZHZUXESVWRUXRSZVWKUXSVWDVWRUXEUXRVW
      DUXEVWRUXRVWDUXEVVMAOZUAFXDZVWSVWDUWPFGZUUDUXEVXAVBVWDVUTUWOXEGZVXBVWNVVK
      VXCUUDUYRUWOXFZXGZBUWOXIRZVVKUUDUYRWLUAUWPAXHRVVKUYRVXAVWSSUUDVVKUYRHZVWT
      VWSUAFVXGVUFHVVMUXJLMZVVMUWQLMZUFZHZUXIVVMLMZSZVWTVWSVVKVUFUYRVXMVVKVUFHZ
      UYRHZVUBVUCVXKVXLVUFUYRVUDVVKVVEXJVXOVXHUYSVXJVUAVXOVXHVVMVWELMZUYSVXOUXJ
      VWEVVMLVXOUXJUUSBUWPKJZKJZVWEVXOUXIVXQUUSKVXOUXIUWPBKJZVXQVXOVURVXCUXIVXS
      OZVXOBUDGZVURUUFVYAVXNUYIBXKVIZBXLTZVVKVXCVUFUYRVXDXGZBUWOXMZRVXOUWPVEGZV
      URVXSVXQOVXOUWPUDGZVYFVXOVYAVXCVYGVYBVYDBUWOXNRZUWPXLTZVYCUWPBVJRWPZPVXOV
      UQVURVYFVWEVXROZUYIVUQVXNUUFVUSVGVYCVYIUUSBUWPXOZVOXPQVXOVUFVWLVXBUWPWHXQ
      ZVXPUYSVBVVKVUFUYRWLZVXOUYIVUTVWLVXNUUFUYIVPZVXOVYAVUTVYBBXTTZVWORVXOVYGV
      XBVYHUWPXTTZVXOVYGVYMVYHUWPXRTZUWPUVJUYKXSYAYBVXOVXIUYTVXOVUFUYIVXBVYMVXI
      UYTVBVYNVYOVYQVYRUWPUVJUUSXSYAUNUMVXOVXLVXQVVMLMZVUCVXOUXIVXQVVMLVYJUOVXO
      VUTVUFVXBVYMVYSVUCVBVYPVYNVYQVYRUWPBUVJXSYAYBWSYCVWTVXKVWRVXLUXRVWTVXHUXK
      VXJVWQVVMAUXJLUSVWTVXIUWRVVMAUWQLUSUNUMVVMAUXILUTUPYDYEYFVQYGYJVWDVWJVWRU
      XEVWDVWFUXKVWIVWQVWDVWEUXJALVWDVWEVXRUXJVWDVUQVURVYFVYKVWDUYIVUQVWMVUSTZV
      WDVUTVURVWNVVCTZVWDVXBVYFVXFUWPVFTZVYLVOVWDVXQUXIUUSKVWDVXQVXSUXIVWDVURVY
      FVXQVXSOWUAWUBBUWPVJRVWDVURVXCVXTWUAVXEVYERXPPWPQVWDVWHUWRVWDVWGUWQALVWDV
      WGUUSBUWTKJZKJZUWQVWDVUQVURUWTVEGZVWGWUDOVYTWUAVWDUWTFGZWUEVWDVUTUWSXEGZW
      UFVWNVVKWUGUUDUYRUWOYHXGBUWSXIRUWTVFTZUUSBUWTXOVOVWDWUCUWPUUSKVWDWUCUWTBK
      JZUWPVWDVURWUEWUCWUIOWUAWUHBUWTVJRVWDVURVVKUWPWUIOWUAVVKUUDUYRUIBUWOYKRXP
      PWPQUNUMWTVWDUXQVWRUXRVWDUXPVWQUXKVWDUXOUWRVWDUXNUWQALVWDUXMUWPUUSKVWDUXL
      UWOBIVWDUWOVEGZNVEGUXLUWOOVVKWUJUUDUYRUWOXLXGWIUWONYIYLPPQUNYMWTWSYNWCYOY
      PYQWAYJYRYSYTXJUVFUVHECFUUSCOZUVEUUQUURWUKUVAUUKUVDUUPWUKUUTUUJALUUSCUUIK
      ULQWUKUVCUUOWUKUVBUUNALUUSCUUMKULQUNUMWTXCUUAUUB $.
      $( [2-Mar-2014] $)
  $}

  ${
    pockthg.1 $e |- ( ph -> A e. NN ) $.
    pockthg.2 $e |- ( ph -> B e. NN ) $.
    pockthg.3 $e |- ( ph -> B < A ) $.
    pockthg.4 $e |- ( ph -> N = ( ( A x. B ) + 1 ) ) $.
    ${
      pockthlem.5 $e |- ( ph -> P e. Prime ) $.
      pockthlem.6 $e |- ( ph -> P || N ) $.
      pockthlem.7 $e |- ( ph -> Q e. Prime ) $.
      pockthlem.8 $e |- ( ph -> ( Q pCnt A ) e. NN ) $.
      pockthlem.9 $e |- ( ph -> C e. ZZ ) $.
      pockthlem.10 $e |- ( ph -> ( ( C ^ ( N - 1 ) ) mod N ) = 1 ) $.
      pockthlem.11 $e |- ( ph ->
                          ( ( ( C ^ ( ( N - 1 ) / Q ) ) - 1 ) gcd N ) = 1 ) $.
      $( Lemma for ~ pockthg . $)
      pockthlem $p |- ( ph -> ( Q pCnt A ) <_ ( Q pCnt ( P - 1 ) ) ) $=
        ( c1 wcel cpc co cmin cle wbr cexp cdivides cod cfv cdiv cz cprime cmul
        cn wn pcdvds syl11anc nnz dvdsmul1 caddc opreq1d cc wceq nnmulcl ax-1cn
        syl nncn pncan sylancl eqtrd breqtrrd wa wi cn0 prmnn pccl nnexpcl nnuz
        1z syl6eleq eluzp1p1 eqeltrd eluzp1m1 syl6eleqr dvdstr syl111anc mp2and
        cuz sylancr cc0 wne wb nnne0 divides2 mpbid gcddvds simpld simprd gcdcl
        cgcd nn0z clt c2 fveq2i eluz2b2 sylib simpr necon3ai dvdslegcd syl31anc
        df-2 cmo nnnn0 zexpcl modgcd gcdcom gcd1 3eqtr3d rpexp breqtrd syl21anc
        gcdn0cl nnle1eq1 odcl cr nnre 1mod eqtr4d moddvds peano2zm oddvds recnd
        a1i divcan1 nprmdvds1 iddvdsexp nn0ge0 nngt0 ge0div breq2d elnn0z expm1
        sylanbrc dvdsgcd mpan2d opreq2d nndivre divass syl112anc 3eqtr2d bitr4d
        3imtr3d mtod prmpwdvds syl222anc odphi phiprm prmuz2 pcdvdsb mpbird
        cphi ) AFBUAUBZFESUCUBZUAUBUDUEZFUVBUFUBZUVCUGUEZAUVEDEUHUIUIZUGUEZUVGU
        VCUGUEZUVFAGSUCUBZUVEUJUBZUKTZUVGUKTZFULTZUVBUNTZUVGUVKUVEUMUBZUGUEUVGU
        VKFUVBSUCUBUFUBZUMUBZUGUEZUOUVHAUVEUVJUGUEZUVLAUVEBUGUEZBUVJUGUEZUVTAUV
        NBUNTZUWANHFBUPUQABBCUMUBZUVJUGABUKTZCUKTZBUWDUGUEAUWCUWEHBURVFZACUNTZU
        WFICURVFBCUSUQAUVJUWDSUTUBZSUCUBZUWDAGUWISUCKVAAUWDVBTZSVBTUWJUWDVCAUWD
        UNTZUWKAUWCUWHUWLHIBCVDUQZUWDVGVFVEUWDSVHVIVJVKAUVEUKTZUWEUVJUKTZUWAUWB
        VLUVTVMAUVEUNTZUWNAFUNTZUVBVNTZUWPAUVNUWQNFVOVFZAUVNUWCUWRNHFBVPUQZFUVB
        VQUQZUVEURVFZUWGAUVJUNTZUWOAUVJSWHUIZUNASUKTZGSSUTUBZWHUIZTUVJUXDTVSAGU
        WIUXGKAUWDUXDTUWIUXGTAUWDUNUXDUWMVRVTSUWDWAVFWBZSGWCWIVRWDZUVJURVFZUVEB
        UVJWEWFWGZAUWNUVEWJWKZUWOUVTUVLWLUXBAUWPUXLUXAUVEWMVFZUXJUVEUVJWNWFWOAU
        VGUNTZUVMAEUNTZDUKTZDEWTUBZSVCZUXNAEULTZUXOLEVOVFZPAUXQSUDUEZUXRAUXQDGW
        TUBZSUDAUXQDUGUEZUXQGUGUEZUXQUYBUDUEZAUYCUXQEUGUEZAUXPEUKTZUYCUYFVLPAUX
        OUYGUXTEURVFZDEWPUQZWQAUYFEGUGUEZUYDAUYCUYFUYIWRMAUXQUKTZUYGGUKTZUYFUYJ
        VLUYDVMAUXQVNTZUYKAUXPUYGUYMPUYHDEWSUQUXQXAVFZUYHAGUNTZUYLAUYOSGXBUEZAG
        XCWHUIZTUYOUYPVLAGUXGUYQUXHXCUXFWHXKXDZWDGXEXFZWQZGURVFZUXQEGWEWFWGAUYK
        UXPUYLDWJVCZGWJVCZVLZUOZUYCUYDVLUYEVMUYNPVUAAGWJWKZVUEAUYOVUFUYTGWMVFVU
        DGWJVUBVUCXGXHVFUXQDGXIXJWGADUVJUFUBZGWTUBZSVCZUYBSVCZAVUGGXLUBZGWTUBZS
        GWTUBZVUHSAVUKSGWTQVAAVUGUKTZUYOVULVUHVCAUXPUVJVNTZVUNPAUXCVUOUXIUVJXMV
        FZDUVJXNUQZUYTVUGGXOUQAVUMGSWTUBZSAUXEUYLVUMVURVCVSVUASGXPWIAUYLVURSVCV
        UAGXQVFVJXRAUXPUYLUXCVUIVUJWLPVUAUXIDGUVJXSWFWOXTAUXQUNTZUYAUXRWLAUXPUY
        GVUBEWJVCZVLZUOZVUSPUYHAEWJWKZVVBAUXOVVCUXTEWMVFVVAEWJVUBVUTXGXHVFDEYBY
        AUXQYCVFWOZDEYDWFUVGURVFZNOAUVGUVJUVPUGAEVUGSUCUBZUGUEZUVGUVJUGUEZAUYJG
        VVFUGUEZVVGMAVUKSGXLUBZVCZVVIAVUKSVVJQAGYETZUYPVVJSVCAUYOVVLUYTGYFVFAUY
        OUYPUYSWRGYGUQYHAUYOVUNUXEVVKVVIWLUYTVUQUXEAVSYMVUGSGYIWFWOAUYGUYLVVFUK
        TZUYJVVIVLVVGVMUYHVUAAVUNVVMVUQVUGYJVFEGVVFWEWFWGAUXOUXPUXRVUOVVGVVHWLU
        XTPVVDVUPDUVJEYKXJWOAUVJVBTUVEVBTZUXLUVPUVJVCAUVJAUXCUVJYETZUXIUVJYFVFZ
        YLAUWPVVNUXAUVEVGVFZUXMUVJUVEYNWFZVKAUVSESUGUEZAUXSVVSUOLEYOVFAEDUVJFUJ
        UBZUFUBZSUCUBZUGUEZEVWBGWTUBZUGUEZUVSVVSAVWCUYJVWEMAUYGVWBUKTZUYLVWCUYJ
        VLVWEVMUYHAVWAUKTZVWFAUXPVVTVNTZVWGPAVVTUKTZWJVVTUDUEZVWHAFUVJUGUEZVWIA
        FUVEUGUEZUVTVWKAFUKTZUVOVWLAUWQVWMUWSFURVFZOFUVBYPUQUXKAVWMUWNUWOVWLUVT
        VLVWKVMVWNUXBUXJFUVEUVJWEWFWGAVWMFWJWKZUWOVWKVWIWLVWNAUWQVWOUWSFWMVFZUX
        JFUVJWNWFWOAWJUVJUDUEZVWJAVUOVWQVUPUVJYQVFAVVOFYETZWJFXBUEZVWQVWJWLVVPA
        UWQVWRUWSFYFVFZAUWQVWSUWSFYRVFUVJFYSWFWOVVTUUAUUCZDVVTXNUQVWAYJVFVUAEVW
        BGUUDWFUUEAVWCUVGVVTUGUEZUVSAUXOUXPUXRVWHVWCVXBWLUXTPVVDVXADVVTEYKXJAUV
        RVVTUVGUGAUVRUVKUVEFUJUBZUMUBZUVPFUJUBZVVTAUVQVXCUVKUMAFVBTZVWOUVOUVQVX
        CVCAFVWTYLZVWPOFUVBUUBWFUUFAUVKVBTVVNVXFVWOVXEVXDVCAUVKAVVOUWPUVKYETVVP
        UXAUVJUVEUUGUQYLVVQVXGVWPUVKUVEFUUHUUIAUVPUVJFUJVVRVAUUJYTUUKAVWDSEUGRY
        TUULUUMUVGFUVKUVBUUNUUOAUVGEUVAUIZUVCUGAUXOUXPUXRUVGVXHUGUEUXTPVVDDEUUP
        WFAUXSVXHUVCVCLEUUQVFXTAUWNUVMUVCUKTZUVHUVIVLUVFVMUXBVVEAUVCUNTZVXIAUVC
        UXDUNAUXEEUXGTUVCUXDTVSAEUYQUXGAUXSEUYQTLEUURVFUYRVTSEWCWIVRWDZUVCURVFU
        VEUVGUVCWEWFWGAUVNVXJUWRUVDUVFWLNVXKUWTUVBFUVCUUSWFUUT $.
        $( [2-Mar-2014] $)
    $}

    $(
    pockthg @p |- ( ph -> ( N e. Prime <-> A. p e. Prime ( p || A -> E. x e. ZZ
                   ( ( ( x ^ ( N - 1 ) ) mod N ) = 1 /\
                     ( ( ( x ^ ( ( N - 1 ) / p ) ) - 1 ) gcd N ) = 1 ) ) ) ) @=
      ? @.
    $)

    $d p q x N $.  $d p x A $.  $d p q x ph $.
    pockthg.5 $e |- ( ph -> A. p e. Prime ( p || A -> E. x e. ZZ
                   ( ( ( x ^ ( N - 1 ) ) mod N ) = 1 /\
                     ( ( ( x ^ ( ( N - 1 ) / p ) ) - 1 ) gcd N ) = 1 ) ) ) $.
    $( The generalized Pocklington's theorem.  If ` N - 1 = A x. B ` where
       ` B < A ` , then ` N ` is prime if and only if for every prime factor
       ` p ` of ` A ` , there is an ` x ` such that
       ` x ^ ( N - 1 ) = 1 ( mod N ) ` and
       ` gcd ( x ^ ( ( N - 1 ) / p ) - 1 , N ) = 1 ` .  (Contributed by Mario
       Carneiro, 3-Mar-2014.) $)
    pockthg $p |- ( ph -> N e. Prime ) $=
      ( wcel co cle wbr c1 cn syl wa adantr vq c2 cuz cfv cv cdivides wn cprime
      cexp wi wral cmul caddc nnmulcl syl11anc nnuz syl6eleq eluzp1p1 syl6eleqr
      df-2 fveq2i eqeltrd clt cr eluzelre nnre resqcl prmnn ad2antrl cc0 ltmul2
      wb nngt0 syl112anc mpbid nnltp1le cc wceq recnd 3brtr4d cmin cpc cmo cdiv
      sqval cgcd cz wrex wo cn0 simpr pccl elnn0 sylib nncn exp1 nnge1 ad2antll
      3syl simprl ad2antrr a1i pcdvdsb syl111anc eqbrtrrd id syl5com w3a simpl1
      1nn0 simpl2l simpl2r simpl3l simpl3r simprrl simprrr pockthlem expr 3expa
      rexlimdva syld prmuz2 uz2m1nn syl2anc breq1 syl5ibrcom a1dd jaod ralimdva
      nn0ge0 mpd pc2dvds mpbird dvdsle nnnn0 nn0ltlem1 lt2sq syl22anc lelttrd
      nnz ltnle con2d ralrimiva isprm5 sylanbrc ) AEUBUCUDZLZUAUEZUBUIMZENOZUUH
      EUFOZUGUJZUAUHUKEUHLAECDULMZPUMMZUUFJAUUNPPUMMZUCUDZUUFAUUMPUCUDZLUUNUUPL
      AUUMQUUQACQLZDQLZUUMQLZGHCDUNUOZUPUQPUUMURRUBUUOUCUTVAUSVBZAUULUAUHAUUHUH
      LZSUUKUUJAUVCUUKUUJUGZAUVCUUKSZSZEUUIVCOZUVDUVFECUBUIMZUUIAEVDLZUVEAUUGUV
      IUVBUBEVERTZAUVHVDLZUVEACVDLZUVKAUURUVLGCVFRZCVGRTUVFUUHVDLZUUIVDLZUVFUUH
      QLZUVNUVCUVPAUUKUUHVHVIZUUHVFRZUUHVGRZAEUVHNOUVEAUUNCCULMZEUVHNAUUMUVTVCO
      ZUUNUVTNOZADCVCOZUWAIADVDLZUVLUVLVJCVCOZUWCUWAVLAUUSUWDHDVFRUVMUVMAUURUWE
      GCVMRDCCVKVNVOAUUTUVTQLZUWAUWBVLUVAAUURUURUWFGGCCUNUOUUMUVTVPUOVOJACVQLUV
      HUVTVRACUVMVSCWERVTTUVFCUUHVCOZUVHUUIVCOZUVFUWGCUUHPWAMZNOZUVFCUWIUFOZUWJ
      UVFUWKFUEZCWBMZUWLUWIWBMZNOZFUHUKZUVFUWLCUFOZBUEZEPWAMZUIMEWCMPVRZUWRUWSU
      WLWDMUIMPWAMEWFMPVRZSZBWGWHZUJZFUHUKZUWPAUXEUVEKTUVFUXDUWOFUHUVFUWLUHLZSZ
      UWMQLZUWMVJVRZWIZUXDUWOUJZUXGUWMWJLZUXJUXGUXFUURUXLUVFUXFWKUVFUURUXFAUURU
      VEGTZTUWLCWLUOUWMWMWNUXGUXHUXKUXIUVFUXFUXHUXKUVFUXFUXHSZSZUXDUXCUWOUXOUWQ
      UXDUXCUXOUWLPUIMZUWLCUFUXOUWLQLZUWLVQLUXPUWLVRUXFUXQUVFUXHUWLVHVIUWLWOUWL
      WPWSUXOPUWMNOZUXPCUFOZUXHUXRUVFUXFUWMWQWRUXOUXFUURPWJLZUXRUXSVLUVFUXFUXHW
      TAUURUVEUXNGXAUXTUXOXJXBPUWLCXCXDVOXEUXDXFXGAUVEUXNUXCUWOUJAUVEUXNXHZUXBU
      WOBWGUYAUWRWGLZUXBUWOUYAUYBUXBSZSZCDUWRUUHUWLEUYDAUURAUVEUXNUYCXIZGRUYDAU
      USUYEHRUYDAUWCUYEIRUYDAEUUNVRUYEJRUVCUUKAUXNUYCXKUVCUUKAUXNUYCXLUXFUXHAUV
      EUYCXMUXFUXHAUVEUYCXNUYAUYBUXBWTUYAUYBUWTUXAXOUYAUYBUWTUXAXPXQXRXTXSYAXRU
      XGUXIUWOUXDUXGUWOUXIVJUWNNOZUXGUWNWJLZUYFUXFUXFUWIQLZUYGUVFUXFXFUVCUYHAUU
      KUVCUUHUUFLUYHUUHYBUUHYCRVIZUWLUWIWLYDUWNYJRUWMVJUWNNYEYFYGYHYKYIYKUVFUUR
      UYHUWKUWPVLUXMUYICUWIFYLUOYMUVFCWGLZUYHUWKUWJUJAUYJUVEAUURUYJGCYTRTUYICUW
      IYNUOYKUVFCWJLZUUHWJLZUWGUWJVLAUYKUVEAUURUYKGCYORZTUVFUVPUYLUVQUUHYORZCUU
      HYPUOYMUVFUVLVJCNOZUVNVJUUHNOZUWGUWHVLAUVLUVEUVMTAUYOUVEAUYKUYOUYMCYJRTUV
      RUVFUYLUYPUYNUUHYJRCUUHYQYRVOYSUVFUVIUVOUVGUVDVLUVJUVSEUUIUUAUOVOXRUUBUUC
      UAEUUDUUE $.
      $( [2-Mar-2014] $)
  $}

  ${
    $d x y D $.  $d x y E $.  $d x y N $.  $d x y P $.  $d y A $.
    pockthi.p $e |- P e. Prime $.
    pockthi.g $e |- G e. NN $.
    pockthi.m $e |- M = ( G x. P ) $.
    pockthi.n $e |- N = ( M + 1 ) $.
    pockthi.d $e |- D e. NN $.
    pockthi.e $e |- E e. NN $.
    pockthi.a $e |- A e. NN $.
    pockthi.fac $e |- M = ( D x. ( P ^ E ) ) $.
    pockthi.gt $e |- D < ( P ^ E ) $.
    pockthi.mod $e |- ( ( A ^ M ) mod N ) = ( 1 mod N ) $.
    pockthi.gcd $e |- ( ( ( A ^ G ) - 1 ) gcd N ) = 1 $.
    $( Pocklington's theorem, which gives a sufficient criterion for a number
       ` N ` to be prime.  This is the preferred method for verifying large
       primes, being much more efficient to compute than trial division.  This
       form has been optimized for application to specific large primes; see
       ~ pockthg for a more general closed-form version.  (Contributed by Mario
       Carneiro, 2-Mar-2014.) $)
    pockthi $p |- N e. Prime $=
      ( co c1 vy vx cn wcel cprime cexp cn0 prmnn ax-mp nnnn0i nnexpcl mp2an id
      a1i clt wbr cmul caddc wceq nncni mulcomi eqtri opreq1i cdivides cmin cmo
      cv cdiv cgcd wa cz wrex wi wb prmdvdsexpb mp3an23 eqcomi nnmulcli eqeltri
      wral peano2nn ax-1cn subadd2i mpbir opreq2i cr nnrei cc0 nngt0i ltaddpos2
      1re mpbi breqtrri 1mod 3eqtri opreq2 3eqtrri subcli nnne0i divmuli syl6eq
      opreq2d opreq1d eqeq1d mpbiri nnzi opreq1 anbi12d rcla4ev sylancr pockthg
      mpan syl6bi rgen ) BUCUDZGUEUDLXOUACDUFSZBGUBXPUCUDZXOCUCUDZDUGUDXQCUEUDZ
      XRHCUHUIZDMUJCDUKULZUNXOUMBXPUOUPXOPUNGXPBUQSZTURSZUSXOGFTURSZYCKFYBTURFB
      XPUQSYBOBXPBLUTXPYAUTVAVBVCVBUNUBVGZXPVDUPZUAVGZGTVESZUFSZGVFSZTUSZYGYHYE
      VHSZUFSZTVESZGVISZTUSZVJZUAVKVLZVMZUBUEVTXOYSUBUEYEUEUDZYFYECUSZYRYTXSDUC
      UDYFUUAVNHMYECDVOVPUUAAYHUFSZGVFSZTUSZAYLUFSZTVESZGVISZTUSZYRUUCAFUFSZGVF
      STGVFSZTUUBUUIGVFYHFAUFYHFUSYDGUSGYDKVQGTFGGYDUCKFUCUDYDUCUDFECUQSZUCJECI
      XTVRVSZFWAUIVSZUTZWBFUULUTWCWDZWEVCQGWFUDTGUOUPUUJTUSGUUMWGTYDGUOWHFUOUPZ
      TYDUOUPZFUULWIFWFUDTWFUDUUPUUQVNFUULWGWKFTWJULWLKWMGWNULWOUUAUUHAEUFSZTVE
      SZGVISZTUSRUUAUUGUUTTUUAUUFUUSGVIUUAUUEUURTVEUUAYLEAUFUUAYLYHCVHSZEYECYHV
      HWPUVAEUSCEUQSZYHUSYHFUUKUVBUUOJECEIUTZCXTUTZVAWQYHCEGTUUNWBWRUVDUVCCXTWS
      WTWDXAXBXCXCXDXEAVKUDUUDUUHVJZYRANXFYQUVEUAAVKYGAUSZYKUUDYPUUHUVFYJUUCTUV
      FYIUUBGVFYGAYHUFXGXCXDUVFYOUUGTUVFYNUUFGVIUVFYMUUETVEYGAYLUFXGXCXCXDXHXIX
      LXJXMXNUNXKUI $.
      $( [2-Mar-2014] $)
  $}

  ${
    $d x A $.  $d x N $.
    nprmi.1 $e |- A e. NN $.
    nprmi.2 $e |- B e. NN $.
    nprmi.3 $e |- 1 < A $.
    nprmi.4 $e |- 1 < B $.
    nprmi.5 $e |- N = ( A x. B ) $.
    $( An inference for compositeness.  (Contributed by Mario Carneiro,
       18-Feb-2014.) $)
    nprmi $p |- -. N e. Prime $=
      ( vx cdivides wbr wceq wcel wn cn c1 clt cz nnz nnrei cv wi c2 cuz cprime
      cfv wral wrex wa eluz2b2 mpbir2an cmul nnmulcli eqeltri w3a nncni mulcomi
      co eqtr4i dvds0lem mpan2 syl3an mp3an wne cr cc0 wb nngt0i ltmulgt11 mpbi
      ltneii necomi df-ne pm3.2i breq1 eqeq1 imbi12d notbid annim syl6bbr mp2an
      breqtrri rcla4ev rexnal mulgt1 mp4an biantrur isprm4 bitr4i mtbi ) IUAZCJ
      KZWKCLZUBZIUCUDUFZUGZCUEMZWNNZIWOUHZWPNAWOMZACJKZACLZNZUIZWSWTAOMZPAQKZAU
      JDFUKXAXCBOMZXECOMZXAEDCABULURZOHABDEUMZUNZXGBRMZXEARMZXHCRMZXABSASCSXLXM
      XNUOBAULURZCLXAXOXICBABEUPADUPUQHUSBACUTVAVBVCACVDXCCAACADTZCXKTAXICQPBQK
      ZAXIQKZGAVEMZBVEMZVFAQKXQXRVGXPBETZADVHABVIVCVJHWBVKVLACVMVJVNWRXDIAWOWKA
      LZWRXAXBUBZNXDYBWNYCYBWLXAWMXBWKACJVOWKACVPVQVRXAXBVSVTWCWAWNIWOWDVJWPCWO
      MZWPUIWQYDWPCXIWOHXIWOMXIOMPXIQKZXIUJXJXSXTXFXQYEXPYAFGABWEWFUKUNWGICWHWI
      WJ $.
      $( [18-Feb-2014] $)
  $}

