$(
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
                           Pocklington's theorem
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
$)


  ${
    $d x z P $.
    $( One need only check prime divisors of ` P ` up to ` sqr P ` in order to
       ensure primality.  (Contributed by Mario Carneiro, 18-Feb-2014.) $)
    isprm5 $p |- ( P e. Prime <-> ( P e. ( ZZ>= ` 2 ) /\
                    A. z e. Prime ( ( z ^ 2 ) <_ P -> -. z || P ) ) ) $=
      ( cprime wcel c2 wbr wceq wi wa co cle wn cmul clt c1 cr cc0 syl syl2anc
      wb vx cuz cfv cv cdivides wral cexp isprm4 prmuz2 a1i cn eluz2b2 eluzelre
      simprbi simplbi nngt0 ltmulgt11 syl3anc mpbid oveq12 anidms breq1d notbid
      ax-mulrcl ltnle syl5ibrcom con2 syl6 imim12d ralimdv2 wrex annim ad2antlr
      imim2d wo ad2antrr letric weq anbi12d rcla4ev ancom2s expr ad2ant2lr cdiv
      breq1 cz simprl wne eluzelz nnne0 divides2 cc recnd mulid2 ltlen syl21anc
      dvdsle imp simprr df-ne sylibr necomd mpbir2and eqbrtrd 1re nnre ltmuldiv
      zre jca eluz2b1 sylanbrc nnmulcl nnrp rpdivcl syl2an elrp sylib divmuldiv
      lemul1 syl22anc nncn divass syl112anc eqtrd divcan2 eqcomd breq12d bitr4d
      crp biimpd mpd ex rexlimdva ad2antrl remulcl 3syl cn0 nnnn0 nn0ge0 rexnal
      dvds0lem syl31anc jctird ee12an jaod syl5bir exprmfct prmz simpllr le2msq
      ad3antrrr simplrl letrd simplrr dvdstr mp2and jc reximdva syld impcon4bid
      3imtr3g prmnn sqval imbi1d ralbiia syl6bbr pm5.32i bitri ) BCDBEUBUCZDZAU
      DZBUEFZUVKBGZHZAUVIUFZIUVJUVKEUGJZBKFZUVLLZHZACUFZIABUHUVJUVOUVTUVJUVOUVK
      UVKMJZBKFZUVRHZACUFZUVTUVJUVOUWDUVJUVNUWCAUVICUVJUVKCDZUVKUVIDZUVNUWCUWEU
      WFHUVJUVKUIZUJUVJUVNUVLUWBLZHUWCUVJUVMUWHUVLUVJUWHUVMBBMJZBKFZLZUVJBUWINF
      ZUWKUVJOBNFZUWLUVJBUKDZUWMBULZUNUVJBPDZUWPQBNFZUWMUWLTEBUMZUWRUVJUWNUWQUV
      JUWNUWMUWOUOZBUPRBBUQURUSUVJUWPUWIPDZUWLUWKTUWRUVJUWPUWPUWTUWRUWRBBVDSBUW
      IVESUSUVMUWBUWJUVMUWAUWIBKUVMUWAUWIGUVKBUVKBMUTVAVBVCVFVNUVLUWBVGVHVIVJUV
      JUVNLZAUVIVKZUWCLZACVKZUVOLUWDLUVJUXBUAUDZUXEMJZBKFZUXEBUEFZIZUAUVIVKZUXD
      UVJUXAUXJAUVIUXAUVLUVMLZIZUVJUWFIZUXJUVLUVMVLUXMUXLUXJUXMUXLIZUWBBUWAKFZV
      OZUXJUXNUWAPDZUWPUXPUXNUVKPDZUXRUXQUWFUXRUVJUXLEUVKUMVMZUXSUVKUVKVDSZUVJU
      WPUWFUXLUWRVPZUWABVQSUXNUWBUXJUXOUWFUVLUWBUXJHUVJUXKUWFUVLUWBUXJUWFUWBUVL
      UXJUXIUWBUVLIUAUVKUVIUAAVRZUXGUWBUXHUVLUYBUXFUWABKUYBUXFUWAGUXEUVKUXEUVKM
      UTVAVBUXEUVKBUEWEVSVTWAWBWCUXNBUVKWDJZUVIDZUXOUYCUYCMJZBKFZUYCBUEFZIZUXJU
      XNUYCWFDZOUYCNFZUYDUXNUVLUYIUXMUVLUXKWGZUXNUVKWFDZUVKQWHZBWFDZUVLUYITUWFU
      YLUVJUXLEUVKWIVMZUXNUVKUKDZUYMUWFUYPUVJUXLUWFUYPOUVKNFUVKULUOZVMZUVKWJRZU
      VJUYNUWFUXLEBWIZVPZUVKBWKURUSZUXNOUVKMJZBNFZUYJUXNVUCUVKBNUXNUVKWLDZVUCUV
      KGUXNUVKUXSWMZUVKWNRUXNUVKBNFZUVKBKFZBUVKWHZUXNUXRUWPVUGVUHVUIITUXSUYAUVK
      BWOSUXNUYLUWNUVLVUHUYOUVJUWNUWFUXLUWSVPZUYKUYLUWNIUVLVUHUVKBWQWRWPUXNUVKB
      UXNUXKUVKBWHUXMUVLUXKWSUVKBWTXAXBXCXDUXNOPDZUWPUXRQUVKNFZIZVUDUYJTVUKUXNX
      EUJUXNUYNUWPVUABXHZRUXNUYPVUMUYRUYPUXRVULUVKXFUVKUPXIROBUVKXGURUSUYCXJXKU
      XNUXOUYFUYGUXNUXOUYFUXNUXOBBUWAWDJZMJZUWAVUOMJZKFZUYFUXNUWPUXQVUOPDQVUONF
      IZUXOVURTUYAUXTUXNVUOYIDZVUSUXNUWNUWAUKDZVUTVUJUXNUYPUYPVVAUYRUYRUVKUVKXL
      SZUWNBYIDUWAYIDVUTVVABXMUWAXMBUWAXNXOSVUOXPXQBUWAVUOXSURUXNUYEVUPBVUQKUXN
      UYEUWIUWAWDJZVUPUXNBWLDZVVDVUEUYMIZVVEUYEVVCGUXNBUYAWMZVVFUXNVUEUYMVUFUYS
      XIZVVGBBUVKUVKXRXTUXNVVDVVDUWAWLDZUWAQWHZVVCVUPGVVFVVFUXNVVAVVHVVBUWAYARZ
      UXNVVAVVIVVBUWAWJRZBBUWAYBYCYDUXNVUQBUXNVVDVVHVVIVUQBGVVFVVJVVKBUWAYEURYF
      YGYHYJUXNUYLUYIUYNUVKUYCMJBGZUYGUYOVUBVUAUXNVVDVUEUYMVVLVVFVUFUYSBUVKYEUR
      UVKUYCBUUAUUBUUCUXIUYHUAUYCUVIUXEUYCGZUXGUYFUXHUYGVVMUXFUYEBKVVMUXFUYEGUX
      EUYCUXEUYCMUTVAVBUXEUYCBUEWEVSVTUUDUUEYKYLUUFYMUVJUXIUXDUAUVIUVJUXEUVIDZI
      ZUXIUXDVVOUXIIZUVKUXEUEFZACVKZUXDVVNVVRUVJUXIUXEAUUGVMVVPVVQUXCACVVPUWEVV
      QUXCVVPUWEVVQIZIZUWBUVLVVTUWAUXFBVVTUXRUXRUXQVVTUYLUXRUWEUYLVVPVVQUVKUUHY
      NZUVKXHRZVWBUVKUVKYOSVVTUXEPDZVWCUXFPDVVTVVNUXEWFDZVWCUVJVVNUXIVVSUUIZEUX
      EWIZUXEXHYPZVWGUXEUXEYOSVVTUYNUWPUVJUYNVVNUXIVVSUYTUUKZVUNRVVTUVKUXEKFZUW
      AUXFKFZVVTUYLUXEUKDZVVQVWIVWAVVTVVNVWKVWEVVNVWKOUXENFUXEULUOZRVVPUWEVVQWS
      ZUYLVWKIVVQVWIUVKUXEWQWRWPVVTUXRQUVKKFZVWCQUXEKFZVWIVWJTVWBUWEVWNVVPVVQUW
      EUWFVWNUWGUWFUYPUVKYQDVWNUYQUVKYRUVKYSYPRYNVWGVVTVVNVWKVWOVWEVWLVWKUXEYQD
      VWOUXEYRUXEYSRYPUVKUXEUUJXTUSVVOUXGUXHVVSUULUUMVVTVVQUXHUVLVWMVVOUXGUXHVV
      SUUNVVTUYLVWDUYNVVQUXHIUVLHVWAVVTVVNVWDVWEVWFRVWHUVKUXEBUUOURUUPUUQWBUURY
      KYLYMUUSUVNAUVIYTUWCACYTUVAUUTUVSUWCACUWEUVQUWBUVRUWEUVPUWABKUWEUYPVUEUVP
      UWAGUVKUVBUVKYAUVKUVCYPVBUVDUVEUVFUVGUVH $.
      $( [18-Feb-2014] $)
  $}

  ${
    ndvdsi.1 $e |- A e. NN $.
    ndvdsi.2 $e |- Q e. NN0 $.
    ndvdsi.3 $e |- R e. NN $.
    ndvdsi.4 $e |- B = ( ( A x. Q ) + R ) $.
    ndvdsi.5 $e |- R < A $.
    $( A quick test for non-divisibility.  (Contributed by Mario Carneiro,
       18-Feb-2014.) $)
    ndvdsi $p |- -. A || B $=
      ( cdivides wbr cmul co caddc wn cz wcel nnzi mp2an cn dvdsmul1 clt zmulcl
      nn0zi wa wi pm3.2i ndvdsadd mp3an ax-mp breq2i mtbir ) ABJKAACLMZDNMZJKZA
      UMJKZUOOZAPQZCPQZUPAERZCFUDZACUASUMPQZATQDTQZDAUBKZUEUPUQUFURUSVBUTVAACUC
      SEVCVDGIUGADUMUHUIUJBUNAJHUKUL $.
      $( [18-Feb-2014] $)
  $}

  ${
    $d k n x D $.  $d k K $.  $d k x N $.  $d k n x P $.
    $( A relation involving divisibility by a prime power.  (Contributed by
       Mario Carneiro, 2-Mar-2014.) $)
    prmpwdvds $p |- ( ( ( K e. ZZ /\ D e. ZZ ) /\ ( P e. Prime /\ N e. NN ) /\
         ( D || ( K x. ( P ^ N ) ) /\ -. D || ( K x. ( P ^ ( N - 1 ) ) ) ) ) ->
                   ( P ^ N ) || D ) $=
      ( vk cz wcel wa cexp co cmul cdivides c1 wn wi wceq oveq2d breq2d syl2anc
      wbr vx vn cprime cn cmin cv wral simpll caddc oveq2 notbid anbi12d breq1d
      oveq1 imbi12d ralbidv imbi2d weq breq1 breq2 cgcd wb simplrl coprm cc zcn
      ad2antll ad2antrl syl mulcom simpl gcdcom eqeq1d simprr coprmdvds syl3anc
      prmz sylbid expdimp expimpd ex vtoclga imp anassrs exp1 3syl ad2antlr cc0
      con1d ax-1cn subidi oveq2i simplr exp0 syl5eq adantl mulid1 eqtrd 3imtr4d
      ralrimiva imbi1d cbvralv zmulcl rcla4v wrex nnnn0 ad2antrr zexpcl divides
      cn0 adantll prmnn expp1 nnexpcl mulass eqtr4d wne nnz dvdsmulcr syl112anc
      nncn nnne0 bitrd an32s syl5ibcom rexlimdva adantlr com23 a2d expm1t pncan
      nnm1nn0 sylancl anbi2d syld ralrimdva syl5bi expl nnind com12 impr 3impia
      sylc ) CFGZAFGZHZBUCGZDUDGZHZACBDIJZKJZLTZACBDMUEJZIJZKJZLTZNZHZUUJALTZUU
      FUUIHUUDAEUFZUUJKJZLTZAUUTUUNKJZLTZNZHZUUSOZEFUGZUURUUSOZUUDUUEUUIUHUUEUU
      IUVHUUDUUEUUGUUHUVHUUHUUEUUGHZUVHUVJAUUTBUAUFZIJZKJZLTZAUUTBUVKMUEJZIJZKJ
      ZLTZNZHZUVLALTZOZEFUGZOUVJAUUTBMIJZKJZLTZAUUTBMMUEJZIJZKJZLTZNZHZUWDALTZO
      ZEFUGZOUVJAUUTBUBUFZIJZKJZLTZAUUTBUWPMUEJZIJZKJZLTZNZHZUWQALTZOZEFUGZOUVJ
      AUUTBUWPMUIJZIJZKJZLTZAUUTBUXIMUEJZIJZKJZLTZNZHZUXJALTZOZEFUGZOUVJUVHOUAU
      BDUVKMPZUWCUWOUVJUYBUWBUWNEFUYBUVTUWLUWAUWMUYBUVNUWFUVSUWKUYBUVMUWEALUYBU
      VLUWDUUTKUVKMBIUJZQRUYBUVRUWJUYBUVQUWIALUYBUVPUWHUUTKUYBUVOUWGBIUVKMMUEUN
      QQRUKULUYBUVLUWDALUYCUMUOUPUQUAUBURZUWCUXHUVJUYDUWBUXGEFUYDUVTUXEUWAUXFUY
      DUVNUWSUVSUXDUYDUVMUWRALUYDUVLUWQUUTKUVKUWPBIUJZQRUYDUVRUXCUYDUVQUXBALUYD
      UVPUXAUUTKUYDUVOUWTBIUVKUWPMUEUNQQRUKULUYDUVLUWQALUYEUMUOUPUQUVKUXIPZUWCU
      YAUVJUYFUWBUXTEFUYFUVTUXRUWAUXSUYFUVNUXLUVSUXQUYFUVMUXKALUYFUVLUXJUUTKUVK
      UXIBIUJZQRUYFUVRUXPUYFUVQUXOALUYFUVPUXNUUTKUYFUVOUXMBIUVKUXIMUEUNQQRUKULU
      YFUVLUXJALUYGUMUOUPUQUVKDPZUWCUVHUVJUYHUWBUVGEFUYHUVTUVFUWAUUSUYHUVNUVBUV
      SUVEUYHUVMUVAALUYHUVLUUJUUTKUVKDBIUJZQRUYHUVRUVDUYHUVQUVCALUYHUVPUUNUUTKU
      YHUVOUUMBIUVKDMUEUNQQRUKULUYHUVLUUJALUYIUMUOUPUQUVJUWNEFUVJUUTFGZHZAUUTBK
      JZLTZAUUTLTZNZHZBALTZUWLUWMUUEUUGUYJUYPUYQOZUUEUUGUYJHZUYRUYSUVKUYLLTZUVK
      UUTLTZNZHZBUVKLTZOZOUYSUYROUAAFUVKAPZVUEUYRUYSVUFVUCUYPVUDUYQVUFUYTUYMVUB
      UYOUVKAUYLLUSVUFVUAUYNUVKAUUTLUSUKULUVKABLUTUOUQUVKFGZUYSVUEVUGUYSHZUYTVU
      BVUDVUHUYTHZVUDVUAVUIVUDNZBUVKVAJZMPZVUAVUIUUGVUGVUJVULVBVUGUUGUYJUYTVCVU
      GUYSUYTUHBUVKVDSVUHUYTVULVUAVUHUYTVULHUVKBUUTKJZLTZUVKBVAJZMPZHZVUAVUHUYT
      VUNVULVUPVUHUYLVUMUVKLVUHUUTVEGZBVEGZUYLVUMPUYJVURVUGUUGUUTVFZVGVUHBFGZVU
      SUUGVVAVUGUYJBVQZVHZBVFZVIUUTBVJSRVUHVUKVUOMVUHVVAVUGVUKVUOPVVCVUGUYSVKZB
      UVKVLSVMULVUHVUGVVAUYJVUQVUAOVVEVVCVUGUUGUYJVNUVKBUUTVOVPVRVSVRWIVTZWAWBW
      CWDUYKUWFUYMUWKUYOUYKUWEUYLALUYKUWDBUUTKUUGUWDBPZUUEUYJUUGVVAVUSVVGVVBVVD
      BWEZWFWGQRUYKUWJUYNUYKUWIUUTALUYKUWIUUTMKJZUUTUYKUWHMUUTKUYKUWHBWHIJZMUWG
      WHBIMWJWKWLUYKVUSVVJMPUYKUUGVVAVUSUUEUUGUYJWMVVBVVDWFZBWNVIWOQUYKVURVVIUU
      TPUYJVURUVJVUTWPUUTWQVIWRRUKULUYKUWDBALUYKVUSVVGVVKVVHVIUMWSWTUWPUDGZUVJU
      XHUYAVVLUUEUUGUXHUYAOUXHAUVKUWQKJZLTZAUVKUXAKJZLTZNZHZUXFOZUAFUGZVVLUUEHZ
      UUGHZUYAUXGVVSEUAFEUAURZUXEVVRUXFVWCUWSVVNUXDVVQVWCUWRVVMALUUTUVKUWQKUNRV
      WCUXCVVPVWCUXBVVOALUUTUVKUXAKUNRUKULXAXBVWBVVTUXTEFVWAUUGUYJVVTUXTOVWAUYS
      HZVVTAUYLUWQKJZLTZAUYLUXAKJZLTZNZHZUXFOZUXTVWDUYLFGZVVTVWKOVWDUYJVVAVWLVW
      AUUGUYJVNUUGVVAVWAUYJVVBVHZUUTBXCZSVVSVWKUAUYLFUVKUYLPZVVRVWJUXFVWOVVNVWF
      VVQVWIVWOVVMVWEALUVKUYLUWQKUNRVWOVVPVWHVWOVVOVWGALUVKUYLUXAKUNRUKULXAXDVI
      VWDUXLUWSNZHZUXFOVWQUXSOZVWKUXTVWDVWQUXFUXSVWDUXFVWQUXSVWDUXFVVMAPZUAFXEZ
      VWRVWDUWQFGZUUEUXFVWTVBVWDVVAUWPXJGZVXAVWMVVLVXBUUEUYSUWPXFZXGZBUWPXHSZVV
      LUUEUYSWMUAUWQAXISVVLUYSVWTVWROUUEVVLUYSHZVWSVWRUAFVXFVUGHVVMUXKLTZVVMUWR
      LTZNZHZUXJVVMLTZOZVWSVWRVVLVUGUYSVXLVVLVUGHZUYSHZVUCVUDVXJVXKVUGUYSVUEVVL
      VVFXKVXNVXGUYTVXIVUBVXNVXGVVMVWELTZUYTVXNUXKVWEVVMLVXNUXKUUTBUWQKJZKJZVWE
      VXNUXJVXPUUTKVXNUXJUWQBKJZVXPVXNVUSVXBUXJVXRPZVXNBUDGZVUSUUGVXTVXMUYJBXLV
      HZBYAVIZVVLVXBVUGUYSVXCXGZBUWPXMZSVXNUWQVEGZVUSVXRVXPPVXNUWQUDGZVYEVXNVXT
      VXBVYFVYAVYCBUWPXNSZUWQYAVIZVYBUWQBVJSWRZQVXNVURVUSVYEVWEVXQPZUYJVURVXMUU
      GVUTVGVYBVYHUUTBUWQXOZVPXPRVXNVUGVWLVXAUWQWHXQZVXOUYTVBVVLVUGUYSWMZVXNUYJ
      VVAVWLVXMUUGUYJVNZVXNVXTVVAVYABXRVIZVWNSVXNVYFVXAVYGUWQXRVIZVXNVYFVYLVYGU
      WQYBVIZUWQUVKUYLXSXTYCVXNVXHVUAVXNVUGUYJVXAVYLVXHVUAVBVYMVYNVYPVYQUWQUVKU
      UTXSXTUKULVXNVXKVXPVVMLTZVUDVXNUXJVXPVVMLVYIUMVXNVVAVUGVXAVYLVYRVUDVBVYOV
      YMVYPVYQUWQBUVKXSXTYCWSYDVWSVXJVWQVXKUXSVWSVXGUXLVXIVWPVVMAUXKLUSVWSVXHUW
      SVVMAUWRLUSUKULVVMAUXJLUTUOYEYFYGVRYHYIVWDVWJVWQUXFVWDVWFUXLVWIVWPVWDVWEU
      XKALVWDVWEVXQUXKVWDVURVUSVYEVYJUYJVURVWAUUGVUTVGZVWDVVAVUSVWMVVDVIZVWDVXA
      VYEVXEUWQVFVIZVYKVPVWDVXPUXJUUTKVWDVXPVXRUXJVWDVUSVYEVXPVXRPVYTWUABUWQVJS
      VWDVUSVXBVXSVYTVXDVYDSXPQWRRVWDVWHUWSVWDVWGUWRALVWDVWGUUTBUXAKJZKJZUWRVWD
      VURVUSUXAVEGZVWGWUCPVYSVYTVWDUXAFGZWUDVWDVVAUWTXJGZWUEVWMVVLWUFUUEUYSUWPY
      LXGBUWTXHSUXAVFVIZUUTBUXAXOVPVWDWUBUWQUUTKVWDWUBUXABKJZUWQVWDVUSWUDWUBWUH
      PVYTWUGBUXAVJSVWDVUSVVLUWQWUHPVYTVVLUUEUYSUHBUWPYJSXPQWRRUKULXAVWDUXRVWQU
      XSVWDUXQVWPUXLVWDUXPUWSVWDUXOUWRALVWDUXNUWQUUTKVWDUXMUWPBIVWDUWPVEGZMVEGU
      XMUWPPVVLWUIUUEUYSUWPYAXGWJUWPMYKYMQQRUKYNXAWSYOWDYPYQYRYIYSYTUUAXKUVGUVI
      ECFUUTCPZUVFUURUUSWUJUVBUULUVEUUQWUJUVAUUKALUUTCUUJKUNRWUJUVDUUPWUJUVCUUO
      ALUUTCUUNKUNRUKULXAXDUUCUUB $.
      $( [2-Mar-2014] $)
  $}

  ${
    pockthg.1 $e |- ( ph -> A e. NN ) $.
    pockthg.2 $e |- ( ph -> B e. NN ) $.
    pockthg.3 $e |- ( ph -> B < A ) $.
    pockthg.4 $e |- ( ph -> N = ( ( A x. B ) + 1 ) ) $.
    ${
      pockthlem.5 $e |- ( ph -> P e. Prime ) $.
      pockthlem.6 $e |- ( ph -> P || N ) $.
      pockthlem.7 $e |- ( ph -> Q e. Prime ) $.
      pockthlem.8 $e |- ( ph -> ( Q pCnt A ) e. NN ) $.
      pockthlem.9 $e |- ( ph -> C e. ZZ ) $.
      pockthlem.10 $e |- ( ph -> ( ( C ^ ( N - 1 ) ) mod N ) = 1 ) $.
      pockthlem.11 $e |- ( ph ->
                          ( ( ( C ^ ( ( N - 1 ) / Q ) ) - 1 ) gcd N ) = 1 ) $.
      $( Lemma for ~ pockthg . $)
      pockthlem $p |- ( ph -> ( Q pCnt A ) <_ ( Q pCnt ( P - 1 ) ) ) $=
        ( c1 wcel cpc co cmin cle wbr cexp cdivides cod cfv cdiv cz cprime cmul
        cn wn pcdvds syl2anc nnz syl dvdsmul1 caddc oveq1d cc wceq nnmulcl nncn
        ax-1cn pncan sylancl eqtrd breqtrrd wa wi cn0 prmnn pccl nnexpcl cuz 1z
        nnuz syl6eleq eluzp1p1 eqeltrd eluzp1m1 sylancr syl6eleqr dvdstr mp2and
        syl3anc cc0 wne wb nnne0 divides2 mpbid cgcd gcddvds simpld simprd nn0z
        gcdcl clt c2 fveq2i eluz2b2 sylib simpr necon3ai dvdslegcd syl31anc cmo
        df-2 nnnn0 zexpcl modgcd gcdcom 3eqtr3d rpexp breqtrd syl21anc nnle1eq1
        gcd1 gcdn0cl odcl cr nnre 1mod eqtr4d a1i moddvds peano2zm oddvds recnd
        divcan1 nprmdvds1 iddvdsexp nn0ge0 nngt0 ge0div breq2d sylanbrc dvdsgcd
        elnn0z mpan2d expm1 oveq2d nndivre divass syl112anc 3eqtr2d bitr4d mtod
        3imtr3d prmpwdvds syl222anc cphi odphi phiprm prmuz2 pcdvdsb mpbird ) A
        FBUAUBZFESUCUBZUAUBUDUEZFUVBUFUBZUVCUGUEZAUVEDEUHUIUIZUGUEZUVGUVCUGUEZU
        VFAGSUCUBZUVEUJUBZUKTZUVGUKTZFULTZUVBUNTZUVGUVKUVEUMUBZUGUEUVGUVKFUVBSU
        CUBUFUBZUMUBZUGUEZUOUVHAUVEUVJUGUEZUVLAUVEBUGUEZBUVJUGUEZUVTAUVNBUNTZUW
        ANHFBUPUQABBCUMUBZUVJUGABUKTZCUKTZBUWDUGUEAUWCUWEHBURUSZACUNTZUWFICURUS
        BCUTUQAUVJUWDSVAUBZSUCUBZUWDAGUWISUCKVBAUWDVCTZSVCTUWJUWDVDAUWDUNTZUWKA
        UWCUWHUWLHIBCVEUQZUWDVFUSVGUWDSVHVIVJVKAUVEUKTZUWEUVJUKTZUWAUWBVLUVTVMA
        UVEUNTZUWNAFUNTZUVBVNTZUWPAUVNUWQNFVOUSZAUVNUWCUWRNHFBVPUQZFUVBVQUQZUVE
        URUSZUWGAUVJUNTZUWOAUVJSVRUIZUNASUKTZGSSVAUBZVRUIZTUVJUXDTVSAGUWIUXGKAU
        WDUXDTUWIUXGTAUWDUNUXDUWMVTWASUWDWBUSWCZSGWDWEVTWFZUVJURUSZUVEBUVJWGWIW
        HZAUWNUVEWJWKZUWOUVTUVLWLUXBAUWPUXLUXAUVEWMUSZUXJUVEUVJWNWIWOAUVGUNTZUV
        MAEUNTZDUKTZDEWPUBZSVDZUXNAEULTZUXOLEVOUSZPAUXQSUDUEZUXRAUXQDGWPUBZSUDA
        UXQDUGUEZUXQGUGUEZUXQUYBUDUEZAUYCUXQEUGUEZAUXPEUKTZUYCUYFVLPAUXOUYGUXTE
        URUSZDEWQUQZWRAUYFEGUGUEZUYDAUYCUYFUYIWSMAUXQUKTZUYGGUKTZUYFUYJVLUYDVMA
        UXQVNTZUYKAUXPUYGUYMPUYHDEXAUQUXQWTUSZUYHAGUNTZUYLAUYOSGXBUEZAGXCVRUIZT
        UYOUYPVLAGUXGUYQUXHXCUXFVRXLXDZWFGXEXFZWRZGURUSZUXQEGWGWIWHAUYKUXPUYLDW
        JVDZGWJVDZVLZUOZUYCUYDVLUYEVMUYNPVUAAGWJWKZVUEAUYOVUFUYTGWMUSVUDGWJVUBV
        UCXGXHUSUXQDGXIXJWHADUVJUFUBZGWPUBZSVDZUYBSVDZAVUGGXKUBZGWPUBZSGWPUBZVU
        HSAVUKSGWPQVBAVUGUKTZUYOVULVUHVDAUXPUVJVNTZVUNPAUXCVUOUXIUVJXMUSZDUVJXN
        UQZUYTVUGGXOUQAVUMGSWPUBZSAUXEUYLVUMVURVDVSVUASGXPWEAUYLVURSVDVUAGYBUSV
        JXQAUXPUYLUXCVUIVUJWLPVUAUXIDGUVJXRWIWOXSAUXQUNTZUYAUXRWLAUXPUYGVUBEWJV
        DZVLZUOZVUSPUYHAEWJWKZVVBAUXOVVCUXTEWMUSVVAEWJVUBVUTXGXHUSDEYCXTUXQYAUS
        WOZDEYDWIUVGURUSZNOAUVGUVJUVPUGAEVUGSUCUBZUGUEZUVGUVJUGUEZAUYJGVVFUGUEZ
        VVGMAVUKSGXKUBZVDZVVIAVUKSVVJQAGYETZUYPVVJSVDAUYOVVLUYTGYFUSAUYOUYPUYSW
        SGYGUQYHAUYOVUNUXEVVKVVIWLUYTVUQUXEAVSYIVUGSGYJWIWOAUYGUYLVVFUKTZUYJVVI
        VLVVGVMUYHVUAAVUNVVMVUQVUGYKUSEGVVFWGWIWHAUXOUXPUXRVUOVVGVVHWLUXTPVVDVU
        PDUVJEYLXJWOAUVJVCTUVEVCTZUXLUVPUVJVDAUVJAUXCUVJYETZUXIUVJYFUSZYMAUWPVV
        NUXAUVEVFUSZUXMUVJUVEYNWIZVKAUVSESUGUEZAUXSVVSUOLEYOUSAEDUVJFUJUBZUFUBZ
        SUCUBZUGUEZEVWBGWPUBZUGUEZUVSVVSAVWCUYJVWEMAUYGVWBUKTZUYLVWCUYJVLVWEVMU
        YHAVWAUKTZVWFAUXPVVTVNTZVWGPAVVTUKTZWJVVTUDUEZVWHAFUVJUGUEZVWIAFUVEUGUE
        ZUVTVWKAFUKTZUVOVWLAUWQVWMUWSFURUSZOFUVBYPUQUXKAVWMUWNUWOVWLUVTVLVWKVMV
        WNUXBUXJFUVEUVJWGWIWHAVWMFWJWKZUWOVWKVWIWLVWNAUWQVWOUWSFWMUSZUXJFUVJWNW
        IWOAWJUVJUDUEZVWJAVUOVWQVUPUVJYQUSAVVOFYETZWJFXBUEZVWQVWJWLVVPAUWQVWRUW
        SFYFUSZAUWQVWSUWSFYRUSUVJFYSWIWOVVTUUCUUAZDVVTXNUQVWAYKUSVUAEVWBGUUBWIU
        UDAVWCUVGVVTUGUEZUVSAUXOUXPUXRVWHVWCVXBWLUXTPVVDVXADVVTEYLXJAUVRVVTUVGU
        GAUVRUVKUVEFUJUBZUMUBZUVPFUJUBZVVTAUVQVXCUVKUMAFVCTZVWOUVBUKTZUVQVXCVDA
        FVWTYMZVWPAUVOVXGOUVBURUSFUVBUUEWIUUFAUVKVCTVVNVXFVWOVXEVXDVDAUVKAVVOUW
        PUVKYETVVPUXAUVJUVEUUGUQYMVVQVXHVWPUVKUVEFUUHUUIAUVPUVJFUJVVRVBUUJYTUUK
        AVWDSEUGRYTUUMUULUVGFUVKUVBUUNUUOAUVGEUUPUIZUVCUGAUXOUXPUXRUVGVXIUGUEUX
        TPVVDDEUUQWIAUXSVXIUVCVDLEUURUSXSAUWNUVMUVCUKTZUVHUVIVLUVFVMUXBVVEAUVCU
        NTZVXJAUVCUXDUNAUXEEUXGTUVCUXDTVSAEUYQUXGAUXSEUYQTLEUUSUSUYRWASEWDWEVTW
        FZUVCURUSUVEUVGUVCWGWIWHAUVNVXKUWRUVDUVFWLNVXLUWTUVBFUVCUUTWIUVA $.
        $( [2-Mar-2014] $)
    $}

    $(
    pockthg @p |- ( ph -> ( N e. Prime <-> A. p e. Prime ( p || A -> E. x e. ZZ
                   ( ( ( x ^ ( N - 1 ) ) mod N ) = 1 /\
                     ( ( ( x ^ ( ( N - 1 ) / p ) ) - 1 ) gcd N ) = 1 ) ) ) ) @=
      ? @.
    $)

    $d p q x N $.  $d p x A $.  $d p q x ph $.
    pockthg.5 $e |- ( ph -> A. p e. Prime ( p || A -> E. x e. ZZ
                   ( ( ( x ^ ( N - 1 ) ) mod N ) = 1 /\
                     ( ( ( x ^ ( ( N - 1 ) / p ) ) - 1 ) gcd N ) = 1 ) ) ) $.
    $( The generalized Pocklington's theorem.  If ` N - 1 = A x. B ` where
       ` B < A ` , then ` N ` is prime if and only if for every prime factor
       ` p ` of ` A ` , there is an ` x ` such that
       ` x ^ ( N - 1 ) = 1 ( mod N ) ` and
       ` gcd ( x ^ ( ( N - 1 ) / p ) - 1 , N ) = 1 ` .  (Contributed by Mario
       Carneiro, 3-Mar-2014.) $)
    pockthg $p |- ( ph -> N e. Prime ) $=
      ( wcel co cle wbr c1 cn syl wa adantr vq c2 cuz cfv cv cdivides wn cprime
      cexp wi wral cmul nnmulcl syl2anc nnuz syl6eleq eluzp1p1 fveq2i syl6eleqr
      caddc df-2 eqeltrd clt cr eluzelre nnre resqcl 3syl prmnn ad2antrl cc0 wb
      nngt0 ltmul2 syl112anc mpbid nnltp1le cc wceq recnd sqval 3brtr4d cpc cmo
      cmin cdiv cgcd cz wrex wo simpr ad2antrr pccl elnn0 sylib nncn exp1 nnge1
      cn0 ad2antll simprl 1nn0 a1i pcdvdsb syl3anc eqbrtrrd w3a simpl2l simpl2r
      simpl3l simpl3r simprrl simprrr pockthlem expr rexlimdva 3expa embantd id
      simpl1 prmuz2 uz2m1nn syl2anr breq1 syl5ibrcom a1dd jaod ralimdva pc2dvds
      nn0ge0 mpd mpbird nnz dvdsle nnnn0 nn0ltlem1 lt2sq syl22anc lelttrd ltnle
      con2d ralrimiva isprm5 sylanbrc ) AEUBUCUDZLZUAUEZUBUIMZENOZUUGEUFOZUGUJZ
      UAUHUKEUHLAECDULMZPUTMZUUEJAUUMPPUTMZUCUDZUUEAUULPUCUDZLUUMUUOLAUULQUUPAC
      QLZDQLZUULQLZGHCDUMUNZUOUPPUULUQRUBUUNUCVAURUSVBZAUUKUAUHAUUGUHLZSUUJUUIA
      UVBUUJUUIUGZAUVBUUJSZSZEUUHVCOZUVCUVEECUBUIMZUUHAEVDLZUVDAUUFUVHUVAUBEVER
      TZAUVGVDLZUVDAUUQCVDLZUVJGCVFZCVGVHTUVEUUGQLZUUGVDLZUUHVDLZUVBUVMAUUJUUGV
      IVJZUUGVFZUUGVGVHZAEUVGNOUVDAUUMCCULMZEUVGNAUULUVSVCOZUUMUVSNOZADCVCOZUVT
      IADVDLZUVKUVKVKCVCOZUWBUVTVLAUURUWCHDVFRAUUQUVKGUVLRZUWEAUUQUWDGCVMRDCCVN
      VOVPAUUSUVSQLZUVTUWAVLUUTAUUQUUQUWFGGCCUMUNUULUVSVQUNVPJACVRLUVGUVSVSACUW
      EVTCWARWBTUVECUUGVCOZUVGUUHVCOZUVEUWGCUUGPWEMZNOZUVECUWIUFOZUWJUVEUWKFUEZ
      CWCMZUWLUWIWCMZNOZFUHUKZUVEUWLCUFOZBUEZEPWEMZUIMEWDMPVSZUWRUWSUWLWFMUIMPW
      EMEWGMPVSZSZBWHWIZUJZFUHUKZUWPAUXEUVDKTUVEUXDUWOFUHUVEUWLUHLZSZUWMQLZUWMV
      KVSZWJZUXDUWOUJZUXGUWMWSLZUXJUXGUXFUUQUXLUVEUXFWKAUUQUVDUXFGWLUWLCWMUNUWM
      WNWOUXGUXHUXKUXIUVEUXFUXHUXKUVEUXFUXHSZSZUWQUXCUWOUXNUWLPUIMZUWLCUFUXNUWL
      QLZUWLVRLUXOUWLVSUXFUXPUVEUXHUWLVIVJUWLWPUWLWQVHUXNPUWMNOZUXOCUFOZUXHUXQU
      VEUXFUWMWRWTUXNUXFUUQPWSLZUXQUXRVLUVEUXFUXHXAAUUQUVDUXMGWLUXSUXNXBXCPUWLC
      XDXEVPXFAUVDUXMUXCUWOUJAUVDUXMXGZUXBUWOBWHUXTUWRWHLZUXBUWOUXTUYAUXBSZSZCD
      UWRUUGUWLEUYCAUUQAUVDUXMUYBXTZGRUYCAUURUYDHRUYCAUWBUYDIRUYCAEUUMVSUYDJRUV
      BUUJAUXMUYBXHUVBUUJAUXMUYBXIUXFUXHAUVDUYBXJUXFUXHAUVDUYBXKUXTUYAUXBXAUXTU
      YAUWTUXAXLUXTUYAUWTUXAXMXNXOXPXQXRXOUXGUXIUWOUXDUXGUWOUXIVKUWNNOZUXGUWNWS
      LZUYEUXFUXFUWIQLZUYFUVEUXFXSUVBUYGAUUJUVBUUGUUELUYGUUGYAUUGYBRVJZUWLUWIWM
      YCUWNYJRUWMVKUWNNYDYEYFYGYKYHYKUVEUUQUYGUWKUWPVLAUUQUVDGTUYHCUWIFYIUNYLUV
      ECWHLZUYGUWKUWJUJAUYIUVDAUUQUYIGCYMRTUYHCUWIYNUNYKUVECWSLZUUGWSLZUWGUWJVL
      AUYJUVDAUUQUYJGCYOZRTUVEUVMUYKUVPUUGYOZRCUUGYPUNYLUVEUVKVKCNOZUVNVKUUGNOZ
      UWGUWHVLAUVKUVDUWETAUYNUVDAUUQUYJUYNGUYLCYJVHTUVEUVMUVNUVPUVQRUVEUVMUYKUY
      OUVPUYMUUGYJVHCUUGYQYRVPYSUVEUVHUVOUVFUVCVLUVIUVREUUHYTUNVPXOUUAUUBUAEUUC
      UUD $.
      $( [2-Mar-2014] $)
  $}

  ${
    $d x y D $.  $d x y E $.  $d x y N $.  $d x y P $.  $d y A $.
    pockthi.p $e |- P e. Prime $.
    pockthi.g $e |- G e. NN $.
    pockthi.m $e |- M = ( G x. P ) $.
    pockthi.n $e |- N = ( M + 1 ) $.
    pockthi.d $e |- D e. NN $.
    pockthi.e $e |- E e. NN $.
    pockthi.a $e |- A e. NN $.
    pockthi.fac $e |- M = ( D x. ( P ^ E ) ) $.
    pockthi.gt $e |- D < ( P ^ E ) $.
    pockthi.mod $e |- ( ( A ^ M ) mod N ) = ( 1 mod N ) $.
    pockthi.gcd $e |- ( ( ( A ^ G ) - 1 ) gcd N ) = 1 $.
    $( Pocklington's theorem, which gives a sufficient criterion for a number
       ` N ` to be prime.  This is the preferred method for verifying large
       primes, being much more efficient to compute than trial division.  This
       form has been optimized for application to specific large primes; see
       ~ pockthg for a more general closed-form version.  (Contributed by Mario
       Carneiro, 2-Mar-2014.) $)
    pockthi $p |- N e. Prime $=
      ( co c1 vy vx cn wcel cprime cexp cn0 prmnn ax-mp nnnn0i nnexpcl mp2an id
      a1i clt wbr cmul caddc wceq nncni mulcomi eqtri oveq1i cdivides cmin cdiv
      cv cgcd wa cz wrex wi wral wb prmdvdsexpb mp3an23 eqcomi nnmulcli eqeltri
      cmo peano2nn ax-1cn subadd2i mpbir oveq2i nnrei cc0 nngt0i ltaddpos2 mpbi
      cr breqtrri 1mod 3eqtri oveq2 3eqtrri subcli nnne0i divmuli syl6eq oveq2d
      oveq1d nnzi oveq1 eqeq1d anbi12d rcla4ev mpan sylancr syl6bi rgen pockthg
      1re ) BUCUDZGUEUDLXNUACDUFSZBGUBXOUCUDZXNCUCUDZDUGUDXPCUEUDZXQHCUHUIZDMUJ
      CDUKULZUNXNUMBXOUOUPXNPUNGXOBUQSZTURSZUSXNGFTURSZYBKFYATURFBXOUQSYAOBXOBL
      UTXOXTUTVAVBVCVBUNUBVGZXOVDUPZUAVGZGTVESZUFSZGVTSZTUSZYFYGYDVFSZUFSZTVESZ
      GVHSZTUSZVIZUAVJVKZVLZUBUEVMXNYRUBUEYDUEUDZYEYDCUSZYQYSXRDUCUDYEYTVNHMYDC
      DVOVPYTAYGUFSZGVTSZTUSZAYKUFSZTVESZGVHSZTUSZYQUUBAFUFSZGVTSTGVTSZTUUAUUHG
      VTYGFAUFYGFUSYCGUSGYCKVQGTFGGYCUCKFUCUDYCUCUDFECUQSZUCJECIXSVRVSZFWAUIVSZ
      UTZWBFUUKUTWCWDZWEVCQGWKUDTGUOUPUUITUSGUULWFTYCGUOWGFUOUPZTYCUOUPZFUUKWHF
      WKUDTWKUDUUOUUPVNFUUKWFXMFTWIULWJKWLGWMULWNYTUUFAEUFSZTVESZGVHSTYTUUEUURG
      VHYTUUDUUQTVEYTYKEAUFYTYKYGCVFSZEYDCYGVFWOUUSEUSCEUQSZYGUSYGFUUJUUTUUNJEC
      EIUTZCXSUTZVAWPYGCEGTUUMWBWQUVBUVACXSWRWSWDWTXAXBXBRWTAVJUDUUCUUGVIZYQANX
      CYPUVCUAAVJYFAUSZYJUUCYOUUGUVDYIUUBTUVDYHUUAGVTYFAYGUFXDXBXEUVDYNUUFTUVDY
      MUUEGVHUVDYLUUDTVEYFAYKUFXDXBXBXEXFXGXHXIXJXKUNXLUI $.
      $( [2-Mar-2014] $)
  $}

  ${
    $d x A $.  $d x N $.
    nprmi.1 $e |- A e. NN $.
    nprmi.2 $e |- B e. NN $.
    nprmi.3 $e |- 1 < A $.
    nprmi.4 $e |- 1 < B $.
    nprmi.5 $e |- N = ( A x. B ) $.
    $( An inference for compositeness.  (Contributed by Mario Carneiro,
       18-Feb-2014.) $)
    nprmi $p |- -. N e. Prime $=
      ( vx cdivides wbr wceq wcel wn cn c1 clt cz nnz nnrei cv wi c2 cuz cprime
      cfv wral wrex wa eluz2b2 mpbir2an cmul nnmulcli eqeltri w3a nncni mulcomi
      co eqtr4i dvds0lem mpan2 syl3an mp3an wne cr cc0 wb nngt0i ltmulgt11 mpbi
      ltneii necomi df-ne pm3.2i breq1 eqeq1 imbi12d notbid annim syl6bbr mp2an
      breqtrri rcla4ev rexnal mulgt1 mp4an biantrur isprm4 bitr4i mtbi ) IUAZCJ
      KZWKCLZUBZIUCUDUFZUGZCUEMZWNNZIWOUHZWPNAWOMZACJKZACLZNZUIZWSWTAOMZPAQKZAU
      JDFUKXAXCBOMZXECOMZXAEDCABULURZOHABDEUMZUNZXGBRMZXEARMZXHCRMZXABSASCSXLXM
      XNUOBAULURZCLXAXOXICBABEUPADUPUQHUSBACUTVAVBVCACVDXCCAACADTZCXKTAXICQPBQK
      ZAXIQKZGAVEMZBVEMZVFAQKXQXRVGXPBETZADVHABVIVCVJHWBVKVLACVMVJVNWRXDIAWOWKA
      LZWRXAXBUBZNXDYBWNYCYBWLXAWMXBWKACJVOWKACVPVQVRXAXBVSVTWCWAWNIWOWDVJWPCWO
      MZWPUIWQYDWPCXIWOHXIWOMXIOMPXIQKZXIUJXJXSXTXFXQYEXPYAFGABWEWFUKUNWGICWHWI
      WJ $.
      $( [18-Feb-2014] $)
  $}

